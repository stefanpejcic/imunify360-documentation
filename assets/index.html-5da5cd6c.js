import{_ as h}from"./crontabScanning-8fe4eed0.js";import{_ as m,V as l,n as u,p as g,q as e,J as a,C as t,A as n,v as f,a7 as o}from"./framework-9921d369.js";const b="/images/admin_notify1.png",v="/images/contactsupport_zoom70.png",w="/images/DashboardGeneral3.png",y="/images/Imunify_Advisor.png",_="/images/dashboard_servers2.png",k="/images/copy_key.png",I="/images/id_from_license.png",P="/images/add_server.png",x="/images/add_server_key.png",S="/images/remove_server.png",C="/images/remove_server_popup.png",T="/images/DashboardGeo.png",D="/images/DashboardNum.png",A="/images/IncidentsGeneral.png",M="/images/list.jpg",L="/images/expand.jpg",q="/images/disable_ossec_zoom85.png",N="/images/move_button_zoom94.png",H="/images/IncidentsBulkActions.png",B="/images/Firewall.png",F="/images/addip.png",R="/images/added_zoom80.png",E="/images/north_korea_zoom92.png",W="/images/sucess_country_zoom82.png",O="/images/plus_icon.png",r="/images/tick_icon.png",G="/images/pen_icon.png",U="/images/move_ip_black.png",Y="/images/move_black.png",z="/images/success.jpg",j="/images/delete_permanently.png",K="/images/success_01_zoom75.png",V="/images/global_IP_management.png",J="/images/CLNGroups.png",i="/images/gear.png",Q="/images/change_scope.png",$="/images/Blocked_Ports1.png",X="/images/add_port.png",Z="/images/add_ip_ports.png",ee="/images/add_port_02.png",ae="/images/malwarescanner_general.png",te="/images/malwarescanner_users.png",se="/images/scan_symbol.png",ne="/images/view_report_symbol.png",c="/images/cleanup_symbol.png",p="/images/restore_original_symbol.png",oe="/images/MDSUI.png",ie="/images/view_file_symbol.png",le="/images/malwarescanner_scan_type.png",re="/images/malware_scanner_4_7.png",ce="/images/ondemandscannerprogressbar_zoom70.png",pe="/images/MalwareScannerResults.png",de="/images/malwarescanner_history.png",he="/images/malwarescanner_ignorelist.png",me="/images/bin_symbol.png",ue="/images/plus_symbol.png",ge="/images/proactivedefensemain_zoom70.png",fe="/images/proactivedefensegeneralui_zoom70.png",be="/images/proactivedefensemodesettings_zoom70.png",ve="/images/proactivedefensedetectedevents_zoom70.png",we="/images/proactivedefenseviewfilecontent_zoom70.png",ye="/images/proactivedefenseviewfilecontentway2_zoom70.png",_e="/images/proactivedefensefilecontent_zoom70.png",ke="/images/proactivedefenseblockip_zoom70.png",Ie="/images/proactivedefenseignoredetectedruleforfile_zoom70.png",Pe="/images/proactivedefenseignoredetectedruleforfile1_zoom70.png",xe="/images/proactivedefenseignoreallrulesforfile_zoom70.png",Se="/images/proactivedefenseignoreallrulesforfile1_zoom70.png",Ce="/images/proactivedefenseignorelistbin_zoom70.png",Te="/images/proactivedefenseignorelist_zoom70.png",De="/images/reputation_zoom73.png",Ae="/images/kc_int.jpg",Me="/images/kcint.jpg",Le="/images/settingsgeneralinstallation.png",qe="/images/kc_install_log_zoom91.png",Ne="/images/pep_kernelcare.png",He="/images/waf_wordpress_acp.png",Be="/images/WAF_Compromised_Account_Login_Prevention.png",Fe="/images/WAF_Weak_Password_Login_Prevention.png",Re="/images/cms-specific_waf_rules.png",Ee="/images/DosProtection.png",We="/images/SMTPSettings.png",Oe="/images/SMTPFAQ.png",Ge="/images/3rd_party_protection.png",Ue="/images/auto-whitelist.png",Ye="/images/incidents-logging.png",ze="/images/webshield.png",je="/images/AntiBotProtection.png",Ke="/images/cPanelAccountProtectionFeatureWebshield.png",Ve="/images/ossec_tick.png",Je="/images/pam_module.png",Qe="/images/dovecot.png",$e="/images/ftpBruteForceAttackProtection.png",Xe="/images/error-reporting.png",Ze="/images/contact_details.png",ea="/images/SettingsMalwareResourceConsumption.png",aa="/images/SettingsMalware2.png",ta="/images/background_scanning1.png",sa="/images/malwarescannersettings_zoom70.png",na="/images/SettingsBlamer.png",oa="/images/SettingsPHPImmunity.png",ia="/images/MDSSetUI.png",la="/images/settingsbackup.png",ra="/images/acronisbackup.png",ca="/images/backuprestorecpanel.png",pa="/images/disabledrulesaddbutton_zoom70.png",da="/images/addrule_zoom90.png",ha="/images/disabledruleseditbutton_zoom70.png",ma="/images/disabledrulesenablepopup_zoom60.png",ua="/images/FeaturesManagementGeneral.png",ga="/images/FeaturesManagementTable.png",fa="/images/FeaturesManagementGroupAction.png",ba="/images/FeaturesManagementProactiveDefense.png",va="/images/FeaturesManagementProactiveDefenseConfirmation.png",wa="/images/FeaturesManagementMalwareCleanup.png",ya="/images/FeaturesManagementMalwareCleanupConfirmation.png",_a="/images/NativeFeaturesManagement.png",ka="/images/SwitchToNativeFeaturesManagement.png",Ia="/images/SwitchedFM.png",Pa="/images/WHMPackageExtension.png",xa="/images/pfattr.jpg",Sa="/images/ServiceManagercPanel1.png",Ca="/images/service_status.jpg",Ta={},Da=o('<h1 id="admin-interface" tabindex="-1"><a class="header-anchor" href="#admin-interface" aria-hidden="true">#</a> Admin Interface</h1><p>Imunify360 is an all-in-one security solution with robust cloud protection against the newest attacks, and it is available directly within your control panel (cPanel, Plesk, and DirectAdmin).</p><p>When you log in to your control panel, Imunify360 asks you to enter your email address.</p><p><img src="'+b+'" alt=""></p><p>By entering your email address you agree to receive email reports about critical issues, security alerts or system misconfigurations detected on your servers.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>This email address is used ONLY for receiving server reports.</p></div>',6),Aa={class:"notranslate"},Ma=e("p",null,[a("Log in to your control panel as an admin and go to "),e("span",{class:"notranslate"},"Plugins"),a(", choose Imunify360 to get to the Imunify360 admin interface.")],-1),La=e("p",null,"It allows to access:",-1),qa={class:"notranslate"},Na={class:"notranslate"},Ha={class:"notranslate"},Ba={class:"notranslate"},Fa=e("span",{class:"notranslate"},"Black List, White List",-1),Ra=e("span",{class:"notranslate"},"Gray List",-1),Ea=e("span",{class:"notranslate"},"Blocked Ports",-1),Wa={class:"notranslate"},Oa={class:"notranslate"},Ga={class:"notranslate"},Ua={class:"notranslate"},Ya={class:"notranslate"},za=o('<h2 id="support" tabindex="-1"><a class="header-anchor" href="#support" aria-hidden="true">#</a> Support</h2><p>This tab allows you to contact our support team directly from your Imunify360 Admin Interface. You can create a request and attach some files to it.</p><p>To contact our support team in Imunify360 Admin Interface, please click the <em>Call</em> icon at the top right corner of the page.</p><p><img src="'+v+'" alt=""></p><p>A support ticket will be created and an email will be sent to a specified email address. When a status of your request will change you receive a notification to your email address. You will be able to track your request via <a href="https://cloudlinux.zendesk.com/hc/" target="_blank" rel="noopener noreferrer">https://cloudlinux.zendesk.com/hc/</a> and email.</p><h2 id="dashboard" tabindex="-1"><a class="header-anchor" href="#dashboard" aria-hidden="true">#</a> Dashboard</h2><p>You can access the Imunify360 Dashboard from your control panel. It shows security events as charts and heat maps. It&#39;s a great way to analyze incidents that happened within the past day, week or month.</p><p>Click <span class="notranslate"><em>Dashboard</em></span> tab to display an overview of incidents recorded during the selected time interval, an estimate of the intensity of attacks, and correlate events across all sources.</p><p><img src="'+w+'" alt=""></p><p>Here you can see notifications about server security and Imunify360 configuration, along with recommendations for making server security effective and proactive.</p><h3 id="imunify-advisor" tabindex="-1"><a class="header-anchor" href="#imunify-advisor" aria-hidden="true">#</a> Imunify Advisor</h3><p>The Imunify Advisor checks your server’s current settings, then provides a list of optimal settings for your individual server.</p><p><img src="'+y+'" alt=""></p><p>A dialog box pops up to display recommendations.</p><p>You can accept or reject them (by unchecking a corresponding checkbox) and apply settings by clicking <span class="notranslate"><em>Apply</em></span>.</p><p>Rejected recommendations will not appear again for a while.</p>',16),ja={class:"tip custom-block"},Ka=e("p",{class:"custom-block-title"},"Note",-1),Va=o('<div class="tip custom-block"><p class="custom-block-title">Note</p><p>If your server&#39;s settings differ from the recommended, the Imunify Advisor will pop up again to display the settings.</p></div><div class="notranslate"><h3 id="multi-server-dashboard" tabindex="-1"><a class="header-anchor" href="#multi-server-dashboard" aria-hidden="true">#</a> Multi-server Dashboard</h3></div><p><span class="notranslate">Dashboard</span> can display Imunify360 performance data for a number of specified servers.</p><ul><li><p>You can add a specified server using its server key – a unique server id that identifies an installed Imunify360 instance.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p><strong>Server key is NOT a license key</strong>.</p></div></li><li><p>You can easily remove a server from the Dashboard.</p></li><li><p>You can use <span class="notranslate"><em>Server</em></span> drop-down to show a list of all servers added into the Dashboard.</p></li><li><p>You can choose in the multi-server drop-down for which server the Dashboard would represent its data: a current server (where the Imunify360 is installed) or a remote one (it is indicated on the Dashboard).</p></li></ul><p><img src="'+_+'" alt=""></p><h4 id="how-to-get-a-server-key" tabindex="-1"><a class="header-anchor" href="#how-to-get-a-server-key" aria-hidden="true">#</a> <strong>How to get a server key</strong></h4><p>There are two ways to get a server key.</p><ol><li><p>Click the key symbol <img src="'+k+'" alt=""> to copy server key of the selected server to the clipboard.</p></li><li><p>Go to the <span class="notranslate"><code>/var/imunify360/license.json</code></span> file and find <code>id</code> field. Your server id looks like an alphanumeric string <code>SghjhgFESDh65CFLfvz</code>.</p></li></ol><p><img src="'+I+'" alt=""></p><h4 id="how-to-add-a-server" tabindex="-1"><a class="header-anchor" href="#how-to-add-a-server" aria-hidden="true">#</a> <strong>How to add a server</strong></h4><p>If you&#39;d like to display performance data for the server <strong>A</strong> on the <span class="notranslate">Dashboard</span> of the server <strong>B</strong>, please do the following:</p>',11),Ja=e("strong",null,"A",-1),Qa=e("span",{class:"notranslate"},"Dashboard",-1),$a=e("li",null,[a("Go to the server "),e("strong",null,"B"),a(),e("span",{class:"notranslate"},"Dashboard"),a(" and click the "),e("span",{class:"notranslate"},[e("em",null,"Add Server")]),a(" button "),e("img",{src:P,alt:""})],-1),Xa=e("li",null,[a("The "),e("span",{class:"notranslate"},[e("em",null,"Add server key")]),a(" pop-up opens")],-1),Za=o('<p><img src="'+x+'" alt=""></p><ul><li>Paste the server key belonging to the server <strong>A</strong> to the <span class="notranslate"><em>Server key</em></span> field</li><li>Click <span class="notranslate"><em>Confirm</em></span> to add the server <strong>A</strong> to the <span class="notranslate">Dashboard</span> of the server <strong>B</strong>. To stop adding the server and close the pop-up, click <span class="notranslate"><em>Cancel</em></span>.</li></ul><p>Go to the <span class="notranslate"><em>Server</em></span> drop-down to check all added servers – it contains a list of hostnames of all added servers and/or a list of IPs (if a hostname is not found).</p><h4 id="how-to-remove-a-server" tabindex="-1"><a class="header-anchor" href="#how-to-remove-a-server" aria-hidden="true">#</a> <strong>How to remove a server</strong></h4><p>To remove a server, click the <span class="notranslate"><em>Trash Can</em></span> symbol <img src="'+S+'" alt="">. The <span class="notranslate"><em>Remove Server</em></span> pop-up opens.</p><table><thead><tr><th></th></tr></thead><tbody><tr><td><img src="'+C+'" alt=""></td></tr></tbody></table><p>Click <span class="notranslate"><em>Confirm</em></span> to remove the server. To stop removing the server and close the pop-up, click <span class="notranslate"><em>Cancel</em></span>.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>You cannot remove a server from its <span class="notranslate">Imunify360 Dashboard</span>.</p></div><h3 id="charts-and-heat-maps" tabindex="-1"><a class="header-anchor" href="#charts-and-heat-maps" aria-hidden="true">#</a> Charts and heat maps</h3><p>The following time periods are available:</p><ul><li>Last 24 hours</li><li>Last 7 days</li><li>Last 30 days</li></ul><p>The following representation forms are available:</p><ul><li><strong>Heatmap</strong> visualizes the geographical distribution of incidents</li><li><strong>Histogram</strong> represents the numerical distribution of incidents</li></ul><p><img src="'+T+'" alt=""></p><p><img src="'+D+'" alt=""></p><p>Hover mouse over the particular bar to check the accurate value.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Charts may have gaps. This means that no incidents or alerts were recorded during that day/time period.</p></div><p>The following charts are available.</p><ul><li><strong>Alerts total</strong></li></ul><p>Security incidents recorded within the selected time interval. Data includes all ModSecurity incidents, Imunify360 DOS plugin alerts, cPanel Login Failure Daemon (for cPanel only) and OSSEC alerts. This is a summary of all major alert sources.</p><ul><li><strong>Anti-Bot challenge events</strong></li></ul><p>Recorded requests coming from detected attackers or bad bots that show the Anti-Bot challenge within the selected interval.</p><ul><li><strong>WAF alerts</strong></li></ul><p>Web attacks recorded by ModSecurity within the selected time interval. It may include CMS brute-force and login attempts, websites hacking attempts, attempts to access “sensitive” files or restricted areas, and other malicious requests.</p><ul><li><strong>Web-based Brute-force Attacks</strong></li></ul><p>Web-based brute-force attacks against the CMS and hosting panel, and incidents recorded by ModSecurity.</p><ul><li><strong>OSSEC: Network Level Attacks</strong></li></ul><p>Attacks against network services, e.g. FTP, SSH, POP, IMAP, etc., recorded by OSSEC IDS within the selected time interval. It includes authentication failures, requests from blocked IPs, break-in attempts alerts and more.</p><ul><li><strong>Denied Requests from Bad Bots</strong></li></ul><p>Attacks detected by the Imunify360 Bot-Detector heuristics-based plugin. Bot-Detector is a part of Imunify360’s “cloud heuristics” feature that collects and analyzes a massive amount of information on new attacks on a global scale which it uses to prevent attacks across multiple servers.</p><ul><li><strong>Cleaned malicious files</strong></li></ul><p>This chart lists the number of cleaned malicious files.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Some charts may be hidden if no alerts of a particular type were recorded within the selected time interval.</p></div><h2 id="incidents" tabindex="-1"><a class="header-anchor" href="#incidents" aria-hidden="true">#</a> Incidents</h2>',34),et=e("span",{class:"notranslate"},[e("em",null,"Incidents")],-1),at=o('<p>Use filters to show the exact list of incidents:</p><ul><li><span class="notranslate"><em>Timeframe</em></span> – allows filtering incidents by different time periods.</li><li><span class="notranslate"><em>List</em></span> – allows filtering incidents by <span class="notranslate">White List, Black List</span>, or <span class="notranslate">Gray List</span>, or showing the incidents from all lists.</li><li><span class="notranslate"><em>Search field</em></span> – allows showing all the incidents of a proper IP address, domain or description. Tick <span class="notranslate"><em>Description/IP</em></span> checkbox to enable input field where you can enter a proper IP or a part of it, domain or description and filter the list.</li><li><span class="notranslate"><em>Country</em></span> – allows filtering the incidents by abusers country. Tick <span class="notranslate"><em>Country</em></span> checkbox to enable input field with auto-complete where you can enter a proper country and  filter the incidents by clicking magnifier or <em>Enter</em>.</li></ul><p><img src="'+A+'" alt=""></p><p>Move <em>Auto-refresh</em> to enable or disable automatic refresh of the incidents in the table without reloading the web page.</p><p>The list of incidents contains the following information:</p><ul><li><p><span class="notranslate"><em>Date</em></span> – the time when the incident happened.</p></li><li><p><em>IP</em> - the IP address of the abuser. There is a color indication for IP address.</p><ul><li>A gray bubble means that this IP address is currently in the <span class="notranslate">Gray List</span> (so, every connection from this IP address will redirect to the Anti-Bot Challenge).</li><li>A blue bubble means that this IP address is currently in no one list (<span class="notranslate">White/Gray/Black</span>). IP is not blocked.</li><li>A white bubble means that this IP address is currently in the <span class="notranslate">White List</span>. IP will never be blocked by Imunify360.</li><li>A black bubble means that this IP address is currently in the <span class="notranslate">Black List</span>. And access from this IP is totally blocked without ability to unblock by the Anti-Bot Challenge.</li><li>No bubble is shown when this incident doesn’t contain IP address.</li></ul></li><li><p><span class="notranslate"><em>Country</em></span>– country origin of the abuser IP address.</p></li><li><p><span class="notranslate"><em>Count</em></span> – the number of times the abuser tried to repeat the action.</p></li><li><p><span class="notranslate"><em>Event</em></span> – description of the event or suspicious activity (as it is described by OSSEC and Mod_Security sensors).</p></li><li><p><span class="notranslate"><em>Severity</em></span> – severity level of the incidents (as it is estimated in <a href="https://ossec-docs.readthedocs.io/en/latest/docs/manual/rules-decoders/rule-levels.html?highlight=severity%20level" target="_blank" rel="noopener noreferrer">OSSEC severity levels</a> and <a href="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v2.x%29#severity" target="_blank" rel="noopener noreferrer">Mod_Security severity levels</a>). The color of severity means:</p><ul><li>Green – Mod_Security levels 7-5, OSSEC levels 00-03</li><li>Orange – Mod_Security level 4, OSSEC levels 04-10</li><li>Red – Mod_Security levels 3-0, OSSEC levels 11-15</li></ul></li><li><p><span class="notranslate"><em>Actions</em></span> – actions available for the Incident.</p></li></ul><p><img src="'+M+'" alt=""></p><p>Click an incident to expand the detailed information.</p><p><img src="'+L+`" alt=""></p><p>Starting from version 6.2 Imunify360 will scan zip archives by default. It will not be possible to disable this functionality through the UI, but it will be possible through the command line.</p><p><strong>For Ubuntu, CentOS/CloudLinux &gt;= 7</strong></p><p>To disable scanning of archives, you will need to run the following command:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>echo &#39;&#39; &gt; /etc/sysconfig/aibolit-resident &amp;&amp; systemctl daemon-reload &amp;&amp; systemctl restart aibolit-resident.service
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>To switch the feature back on:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>echo &#39;ARCHIVE_SCAN=&quot;--scan-archive&quot;&#39; &gt; /etc/sysconfig/aibolit-resident &amp;&amp; systemctl daemon-reload &amp;&amp; systemctl restart aibolit-resident.service
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>For CentOS/CloudLinux 6</strong></p><p>To disable scanning of archives, you will need to run the following command:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>sed -i &#39;s/--scan-archive//g&#39; /etc/minidaemon/minidaemon-aibolit.cfg &amp;&amp; /sbin/service minidaemon stop &amp;&amp; /sbin/service minidaemon start
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>To switch the feature back on:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>sed -ri &quot;s/^(cmd=.*)$/\\1--scan-archive/g&quot; /etc/minidaemon/minidaemon-aibolit.cfg &amp;&amp; /sbin/service minidaemon stop &amp;&amp; /sbin/service
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="actions-available-for-the-incidents" tabindex="-1"><a class="header-anchor" href="#actions-available-for-the-incidents" aria-hidden="true">#</a> Actions available for the Incidents</h4><ul><li>Disabling the rule of the incident and add it to the list of Disabled rules. Click <em>Ban</em> icon in a proper incident row and confirm the action.</li></ul><p><img src="`+q+'" alt=""></p><ul><li>Adding IP to the Black or White list. Click <em>Cog</em> icon and choose the action.</li></ul><p><img src="'+N+'" alt=""></p><ul><li>Bulk actions on a list of IPs. The following actions are available: <ul><li>Move to the White list/Black list</li><li>Delete from a list</li><li>Move IPs to the group</li></ul></li></ul><p><img src="'+H+'" alt=""></p><h2 id="firewall" tabindex="-1"><a class="header-anchor" href="#firewall" aria-hidden="true">#</a> Firewall</h2><p>Tne <span class="notranslate"><em>All Lists</em></span> tab allows viewing and managing the IP addresses in the following lists (listed by priority):</p><ul><li><span class="notranslate">White</span> - the IP will not be blocked</li><li><span class="notranslate">Drop/Black</span> - the IP will be blocked everywhere, on all ports and services</li><li><span class="notranslate">Greylist</span> - the IP will be blocked completely on non-web ports (SSH, FTP, etc.), and will be shown Anti-Bot Challenge on web ports (80, 443, hosting panel ports)</li><li><span class="notranslate">Anti-Bot Challenge</span> - the IP will be shown Anti-Bot challenge on web ports, and will not be blocked on others</li></ul><p>The counters for the lists are presented at the top of the table, reflecting the number of records matching the category.</p><p><img src="'+B+'" alt=""></p><p>All the lists are available for search by the IP address as well as by the <em>Country</em> and <em>Comment</em> fields.</p><p>The IP address can be in several lists at the same time, and the highest in priority list decides how the IP will be treated.</p><p>Here, you can add or edit a comment to an IP, delete IP permanently or move it to the White/Black list. For an IP with full access you can also remove it here.</p><p>The <span class="notranslate"><em>Ports</em></span> tab allows to manage the list of blocked ports.</p><h4 id="how-to-add-ip-manually" tabindex="-1"><a class="header-anchor" href="#how-to-add-ip-manually" aria-hidden="true">#</a> How to add IP manually</h4><p>To add an IP, click <span class="notranslate"><em>Add</em></span> on the right side of the page. The following pop-up opens.</p><p><img src="'+F+'" alt=""></p><p>In the pop-up choose <span class="notranslate"><em>IP</em></span> tab and fill out:</p><ul><li><span class="notranslate"><em>Enter IP</em></span> – IP or subnet in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing" target="_blank" rel="noopener noreferrer">CIDR notation</a></li><li><span class="notranslate"><em>Enter a comment</em></span> – type a comment to the IP or subnet (optional)</li><li><span class="notranslate"><em>Enter TTL</em></span> in days or hours – time to live – for how long the IP will be in the White List.</li><li>Choose <em>White List</em> or <em>Black List</em><ul><li>For the White List it is possible to tick <span class="notranslate"><em>Full Access</em></span> checkbox to make this IP or subnet ignore the rules in Blocked ports. The IPs with full access have a crown icon in the IP column.</li></ul><div class="tip custom-block"><p class="custom-block-title">Note</p><p>You can grant or remove full access afterwards in the table, just click <em>Cog</em> icon and choose <span class="notranslate"><em>Grant Full Access</em></span> to grant or <span class="notranslate"><em>Remove Full Access</em></span> to remove it.</p></div></li></ul><p>When done, click <span class="notranslate"><em>Add IP</em></span> to confirm your action or <span class="notranslate"><em>Cancel</em></span> to hide pop-up.</p><p>You will see a notification if an IP has been added successfully.</p><p><img src="'+R+'" alt=""></p><h4 id="how-to-add-a-country-manually" tabindex="-1"><a class="header-anchor" href="#how-to-add-a-country-manually" aria-hidden="true">#</a> How to add a country manually</h4><p>To add a country to the Black List, click <span class="notranslate"><em>Add</em></span> on the right side of the page.</p><p>In the pop-up choose <span class="notranslate"><em>Country</em></span> tab and fill out:</p><ul><li><span class="notranslate"><em>Enter country</em></span> – autocomplete field. Just start typing.</li><li><span class="notranslate"><em>Enter comment</em></span> – type a comment to IP or subnet (optional).</li></ul><p>When done, click <span class="notranslate"><em>Add Country</em></span> to confirm or <span class="notranslate"><em>Cancel</em></span> to close the pop-up.</p><p><img src="'+E+'" alt=""></p><p>Be aware of the possibility that blocking countries can cause unexpected issues, for example visitors from adjacent countries may not be able to connect if at BGP level the decision to send the traffic through the blocked IP was made, when using glued DNS records, or with some mirrors.</p><p>You will see a notification if a country has been added successfully.</p><p><img src="'+W+'" alt=""></p><h4 id="how-to-add-a-comment-to-ip" tabindex="-1"><a class="header-anchor" href="#how-to-add-a-comment-to-ip" aria-hidden="true">#</a> How to add a comment to IP</h4><p>In the proper IP row click <img src="'+O+'" alt=""> in the <span class="notranslate"><em>Comment</em></span> column, type a comment and click <img src="'+r+'" alt="">.</p><p>To remove a comment, click <img src="'+G+'" alt=""> and remove the text. Then click <img src="'+r+'" alt="">.</p><h4 id="how-to-move-ip-from-the-black-list-to-the-white-list" tabindex="-1"><a class="header-anchor" href="#how-to-move-ip-from-the-black-list-to-the-white-list" aria-hidden="true">#</a> How to move IP from the Black List to the White List</h4><p>To move IP from the <span class="notranslate">Black List</span> to the <span class="notranslate">White List</span>, choose proper IPs in the list (use checkboxes), click <span class="notranslate"><em>Group Actions</em></span> at the top of the table and choose <span class="notranslate"><em>Move to White List</em></span> in the drop-down. Then confirm the action.</p><p><img src="'+U+'" alt=""></p><p>To move an exact IP, just click the <em>Cog</em> icon in a proper IP row and choose <span class="notranslate"><em>Move to White List</em></span> in the drop-down. Then confirm the action.</p><p><img src="'+Y+'" alt=""> You will see a notification if an IP is moved to the <span class="notranslate">White List</span> successfully.</p><p><img src="'+z+'" alt=""></p><h4 id="how-to-remove-ip-from-the-black-list" tabindex="-1"><a class="header-anchor" href="#how-to-remove-ip-from-the-black-list" aria-hidden="true">#</a> How to remove IP from the Black List</h4><p>To remove IP from the <span class="notranslate">Black List</span>, choose proper IPs in the table (use checkboxes) and click <span class="notranslate"><em>Delete permanently</em></span>. Then confirm the action.</p><p><img src="'+j+'" alt=""> To remove an exact IP, just click <em>Bin</em> icon in the proper IP row. Then confirm the action.</p><p>You will see a notification if an IP is successfully removed.</p><p><img src="'+K+'" alt=""></p>',67),tt=o('<h3 id="global-black-white-list-ip-management" tabindex="-1"><a class="header-anchor" href="#global-black-white-list-ip-management" aria-hidden="true">#</a> Global Black/White list IP management</h3><p>Administrator can manage IPs globally, this means that you can blacklist or whitelist an IP not only on one server but on a group of servers.</p><p>Prior to manage IPs globally, you should create a group and add servers into it. This can be done via <a href="https://cln.cloudlinux.com/" target="_blank" rel="noopener noreferrer">CLN UI</a>. You can find the complete documentation on how to create and manage servers’ groups <a href="https://docs.cln.cloudlinux.com/dashboard/#server-groups" target="_blank" rel="noopener noreferrer">here</a>.</p><p>When you have created a group in CLN and added IPs into this group, go to <em>Imunify360 &gt; Firewall &gt; White list</em> or <em>Black list</em>. You will see the <em>Scope</em> column and controls (on clicking the <em>Add</em> button) to manage IP locally (on a current server) or globally (on a group of servers).</p><p><img src="'+V+'" alt=""></p><h4 id="how-to-change-scope-to-group-local" tabindex="-1"><a class="header-anchor" href="#how-to-change-scope-to-group-local" aria-hidden="true">#</a> How to change Scope to Group/Local</h4><p>To change the scope to <span class="notranslate"><em>Group/Local</em></span>, first <a href="https://docs.cln.cloudlinux.com/dashboard/#how-to-add-a-server-to-a-group" target="_blank" rel="noopener noreferrer">create your groups</a> in the CLN.</p><p><img src="'+J+'" alt=""></p><p>After that, go to <span class="notranslate"><em>Firewall &gt; White/Black list</em></span> and select an IP.</p><ul><li>In the <span class="notranslate"><em>Actions</em></span> column click <img src="'+i+'" alt="">.</li><li>Choose <span class="notranslate"><em>Change scope to Group/Local</em></span>.</li><li>In the opened popup click <span class="notranslate"><em>Yes, change scope to Group/Local</em></span> or click <span class="notranslate"><em>Cancel</em></span> to close the popup.</li></ul><p><img src="'+Q+'" alt=""></p><h3 id="ports" tabindex="-1"><a class="header-anchor" href="#ports" aria-hidden="true">#</a> Ports</h3><p>This feature allows to block specific ports for TCP/UDP connection. It is also possible to add specific IPs or subnet as a whitelisted so that the rule for the port will not work.</p><p>Click <span class="notranslate"><em>Firewall</em></span> and choose <span class="notranslate"><em>Ports</em></span>.</p><p><img src="'+$+'" alt=""></p><p>Choose the default blocking mode:</p><ul><li>All open, except specified</li><li>All close, except specified</li></ul>',17),st=o('<p>Exact ports and port-ranges to be allowed can be configured by the following fields in the config file:</p><ul><li>FIREWALL.TCP_IN_IPv4</li><li>FIREWALL.TCP_OUT_IPv4</li><li>FIREWALL.UDP_IN_IPv4</li><li>FIREWALL.UDP_OUT_IPv4</li></ul><p>Changes of config files will be applied automatically. You don’t need to restart the server or Imunify360.</p><div class="warning custom-block"><p class="custom-block-title">Note</p><p>The feature doesn’t support IPv6 addresses at this moment and CSF needs to be disabled due to conflicts.</p></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>If CSF integration enabled, then <span class="notranslate">Blocked Ports</span> will be disabled. Imunify360 imports Closed ports and their whitelisted IPs from CSF.</p></div><p>Use filters to show the exact list of the IPs:</p><ul><li><em>IP</em> – allows filtering the list by IP. Enter an IP or a part of it into the input field.</li><li><span class="notranslate"><em>Country</em></span> – allows filtering the list by country origin. Enter a country name into the input field with autocomplete. Imunify360 will show the list of IPs of the chosen country.</li><li><span class="notranslate">Comments</span> – allows filtering the list by comments. Enter a comment into the input field.</li><li>Use <span class="notranslate"><em>Items per page</em></span> at the page bottom right to set the number of the incidents to be shown on the page.</li></ul><p>The following actions are available for the ports:</p><ul><li>add port to the list of blocked ports</li><li>edit ports in the list of blocked ports</li><li>add a comment</li><li>delete permanently</li></ul><h4 id="add-a-port-to-the-list-of-blocked-ports" tabindex="-1"><a class="header-anchor" href="#add-a-port-to-the-list-of-blocked-ports" aria-hidden="true">#</a> Add a port to the list of blocked ports</h4><p>On the <span class="notranslate"><em>Lists</em></span> page choose <span class="notranslate"><em>Blocked ports</em></span> and click <span class="notranslate"><em>Add</em></span>. In the pop-up specify the following:</p><ul><li><span class="notranslate">Port</span> – the number of the port to be added to the list of blocked ports.</li><li>TCP/UDP – tick the checkboxes of connection types for the port that should be blocked.</li><li><span class="notranslate">Enter comment</span> (optional) – a text to be added as a note for the port.</li><li><span class="notranslate">Whitelisted IPs</span> – add IPs separated by comma to the White List. They will be able to use the port.</li></ul><p>Click <span class="notranslate"><em>Add Port</em></span> to proceed or <span class="notranslate"><em>Cancel</em></span> to close the pop-up.</p><p><img src="'+X+'" alt=""></p><h4 id="edit-ports-in-the-blocked-ports-list" tabindex="-1"><a class="header-anchor" href="#edit-ports-in-the-blocked-ports-list" aria-hidden="true">#</a> Edit ports in the blocked ports list</h4><p>To add an IP or a subnet to the <span class="notranslate">White List</span> for the port, click <em>+IP</em> and in the <span class="notranslate"><em>Add IP/Subnet</em></span> pop-up specify the following:</p><ul><li>Enter IP – IP or subnet that should be added to the whitelist</li><li>Enter description – a description to be added as a note to the IP or subnet.</li></ul><p><img src="'+Z+'" alt=""></p><h4 id="delete-permanently" tabindex="-1"><a class="header-anchor" href="#delete-permanently" aria-hidden="true">#</a> Delete permanently</h4><p>To delete a port or separate IP/subnet, click <em>Bin</em> icon in the row of the element.</p><p><img src="'+ee+'" alt=""></p><h2 id="malware-scanner" tabindex="-1"><a class="header-anchor" href="#malware-scanner" aria-hidden="true">#</a> Malware Scanner</h2>',22),nt={class:"tip custom-block"},ot=e("p",{class:"custom-block-title"},"Note",-1),it={class:"notranslate"},lt=o('<p>Imunify360 <span class="notranslate">Malware Scanner</span> can scan file systems for malware injection and clean up infected files.</p><p>This is also a real time file scanner for vulnerability and it can:</p><ul><li><p>scan files uploaded via FTP (supporting <a href="https://www.pureftpd.org/project/pure-ftpd" target="_blank" rel="noopener noreferrer">Pure-FTPd</a>)</p></li><li><p>scan files uploaded via HTTP/HTTPS</p></li><li><p>scan files for changes via <a href="https://en.wikipedia.org/wiki/Inotify" target="_blank" rel="noopener noreferrer">inotify</a></p></li><li><p>scan on-demand (any folder needed)</p></li></ul><p>Malware scanning allows you to:</p><ul><li>observe scanner activity</li><li>start on-demand file scanner</li><li>manage malicious and cleaned up files</li><li>manage Ignore List</li></ul><p>Click <span class="notranslate"><em>Malware Scanner</em></span> in the main menu of the Imunify360 admin interface.</p><p><img src="'+ae+'" alt=""></p><p>The following tabs are available:</p>',8),rt={class:"notranslate"},ct={class:"notranslate"},pt={class:"notranslate"},dt={class:"notranslate"},ht={class:"notranslate"},mt=o('<div class="notranslate"><h3 id="users" tabindex="-1"><a class="header-anchor" href="#users" aria-hidden="true">#</a> Users</h3></div><p>Go to <span class="notranslate">Imunify360 → Malware Scanner → Users</span> tab. Here, there is a table with a list of users on the server, except users with root privileges.</p><p>The badge in the <span class="notranslate"><em>History</em></span> tab shows the number of missed events in the Malware Scanner’s History. You won’t miss any automatic actions applied to infected files, since they are listed in the <span class="notranslate"><em>History</em></span> tab and shown in the badge.</p><p><img src="'+te+'" alt=""></p><p>The table has the following columns:</p><ul><li><span class="notranslate"><strong>User name</strong></span> — displays the user name.</li><li><span class="notranslate"><strong>Home directory</strong></span> — the path to the user home directory starting from the root.</li><li><span class="notranslate"><strong>Infection status</strong></span> — the current status depending on the last action made: <ul><li><span class="notranslate"><strong>On-Demand scanning</strong></span> — scanning was initiated/made by an administrator;</li><li><span class="notranslate"><strong>Scanning queued</strong></span> — user&#39;s files are queued for scanning;</li><li><span class="notranslate"><strong>Background scanning</strong></span> — scheduled scanning is in progress;</li><li><span class="notranslate"><strong>Scanning scheduled</strong></span> — user&#39;s files scanning is scheduled;</li><li><span class="notranslate"><strong>Cleaning up</strong></span> — user&#39;s files are now cleaning up;</li><li><span class="notranslate"><strong>Not yet scanned</strong></span> — user&#39;s files have not been scanned yet;</li><li><span class="notranslate"><strong>No malware found</strong></span> — no malware was found during scanning.</li></ul></li><li><span class="notranslate"><strong>Actions</strong></span>: <ul><li><span class="notranslate"><strong>Scan for malware</strong></span> — click <span class="notranslate"><em>Scan</em></span> <img src="'+se+'" alt=""> to start scanning files for a particular user.</li><li><span class="notranslate"><strong>View report</strong></span> — click <span class="notranslate"><em>View Report</em></span> <img src="'+ne+'" alt=""> to go to the <span class="notranslate"><em>Files</em></span> tab and display the results of the last scan.</li><li><span class="notranslate"><strong>Cleanup</strong></span> — click <span class="notranslate"><em>Cleanup</em></span> <img src="'+c+'" alt=""> to start cleaning up infected files for the user.</li><li><span class="notranslate"><strong>Restore original</strong></span> — click <span class="notranslate"><em>Restore original</em></span> <img src="'+p+'" alt=""> to restore original file after cleaning up if backup is available. To perform a bulk action, tick required users and click the corresponding button above the table.</li></ul></li></ul><p>To clean up all files of all users and scan all files, click <span class="notranslate"><em>Scan all</em></span> or <span class="notranslate"><em>Cleanup all</em></span> button above the table.</p><p>The following filters are available:</p><ul><li><span class="notranslate"><strong>Items per page displayed</strong></span> — click the number at the table bottom.</li></ul><p>The table can be sorted by <span class="notranslate"><em>User name</em></span> and <span class="notranslate"><em>Infection status</em></span> (by the date of the last action).</p><h3 id="malicious" tabindex="-1"><a class="header-anchor" href="#malicious" aria-hidden="true">#</a> Malicious</h3><p>Go to <span class="notranslate">Imunify360 → Malware Scanner → Malicious</span> tab. Here, there is a table with a list of infected files within all domains and user accounts.</p><p><img src="'+oe+'" alt=""></p><p>The table has the following columns:</p><ul><li><span class="notranslate"><strong>Scan date</strong></span> — displays the exact time when a file was detected as malicious.</li><li><span class="notranslate"><strong>Type</strong></span> — <span class="notranslate">Malware Database Scanner</span> or <span class="notranslate">Malware Scanner</span>.<div class="tip custom-block"><p class="custom-block-title">Note</p><p>To function properly <span class="notranslate">Malware Database Scanner</span> requires MariaDB/MySQL DB management system version 5.5. Recommended version is 5.6+. Note, only WordPress databases are supported as for now.</p></div></li><li><span class="notranslate"><strong>Username</strong></span> — displays file owner name.</li><li><span class="notranslate"><strong>Malicious</strong></span> — the path where the file is located starting with root.</li><li><span class="notranslate"><strong>Reason</strong></span> — describes the signature which was detected during the scanning process. Names in this column depend on the signature vendor. You can derive some information from the signature ID itself. <code>SMW-SA-05155-wshll</code> – in this Signature ID: <ul><li>The first section can be either <code>SMW</code> or <code>CMW</code>. <code>SMW</code> stands for Server Malware and <code>CMW</code> stands for Client Malware</li><li>The second section of ID can be either <code>INJ</code> or <code>SA</code>. <code>INJ</code> stands for Injection (means Malware is Injected to some legitimate file) and <code>SA</code> stands for StandAlone (means File is Completely Malicious)</li><li>The third section is <code>05155</code>. This is simply an identification number for the signature.</li><li>The fourth section <code>wshll/mlw.wp/etc</code> explains the category and class of malware identified. Here, <code>wshll</code> stands for web shell (<code>mlw</code> stands for malware).</li><li>The fifth section is <code>0</code>, which provides the version number of the signature.</li></ul></li><li><span class="notranslate"><strong>Status</strong></span> — displays the file status: <ul><li><span class="notranslate"><strong>Infected</strong></span> — threat was detected after scanning. If a file was not cleaned after cleanup, the info icon is displayed. Hover mouse over info icon to display the reason;</li><li><span class="notranslate"><strong>Cleaned</strong></span> — infected file is cleaned up.</li><li><span class="notranslate"><strong>Content removed</strong></span> — a file content was removed after cleanup.</li><li><span class="notranslate"><strong>Cleanup in progress</strong></span> — infected file cleanup is in progress now.</li></ul></li><li><span class="notranslate"><strong>Actions</strong></span>: <ul><li><span class="notranslate"><strong>Add to Ignore List</strong></span> — add file to the <span class="notranslate">Ignore List</span> and remove it from the <span class="notranslate">Malicious files</span> list. Note that if a file is added to the <span class="notranslate">Ignore List</span>, Imunify360 will no longer scan this file. Click the <span class="notranslate"><em>Gear</em></span> symbol <img src="'+i+'" alt=""> and select <span class="notranslate"><em>Add to Ignore List</em></span>.</li><li><span class="notranslate"><strong>View file</strong></span> — click <span class="notranslate"><em>View file</em></span> symbol <img src="'+ie+'" alt=""> in the file line and the file content will be displayed in the pop-up. Only the first 100Kb of the file content will be shown in case if a file has bigger size.</li><li><span class="notranslate"><strong>Cleanup file</strong></span> — click <span class="notranslate"><em>Clean up</em></span> symbol <img src="'+c+'" alt=""> to clean up all infected files within the account.</li><li><span class="notranslate"><strong>Restore original file (before cleanup)</strong></span> — click <span class="notranslate"><em>Restore original</em></span> symbol <img src="'+p+'" alt=""> to restore the original content removed as infected.</li><li><span class="notranslate"><strong>Restore from backup</strong></span> — click the <span class="notranslate"><em>Gear</em></span> symbol <img src="'+i+'" alt=""> and select <span class="notranslate"><em>Try to restore from backup</em></span> to restore the original file before it got infected if it exists.</li></ul></li></ul><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>Starting from ImunifyAV(+) v.6.2, the <em>Quarantine</em> and <em>Delete</em> actions were removed permanently from the UI as well as the CLI in Imunify360. Previously quarantined files are also subject to deletion. After this change is implemented, the restoration of the previously quarantined files will become impossible. For more information see this <a href="https://blog.imunify360.com/file-quarantine-is-no-longer-effective" target="_blank" rel="noopener noreferrer">this blog post</a>.</p></div><p>To perform a bulk action, tick required files and click the corresponding button above the table.</p><p>Click the desired string to display scan type.</p><p><img src="'+le+'" alt=""></p><p>To clean up all files of all users, click <span class="notranslate"><em>Clean up all</em></span> button above the table.</p><p>The following filters are available:</p><ul><li><span class="notranslate"><strong>Timeframe</strong></span> — displays the results filtered by chosen period or date.</li><li><span class="notranslate"><strong>Status</strong></span> — displays the results filtered by chosen status.</li><li><span class="notranslate"><strong>Items per page displayed</strong></span> — click the number at the table bottom.</li></ul><p>The table can be sorted by detection date (detected), user name, file path (file), reason, and status.</p><div class="notranslate"><h3 id="scan" tabindex="-1"><a class="header-anchor" href="#scan" aria-hidden="true">#</a> Scan</h3></div><p>It is possible to scan a specific directory for malware. Go to <span class="notranslate"><em>Malware Scanner</em></span> page and choose <span class="notranslate"><em>Scan</em></span> tab. Then proceed the following steps:</p><ol><li><p>Enter a folder name you need to scan in the <span class="notranslate"><em>Folder to scan</em></span> field. Start typing with the slash <code>/</code>.</p><p>It is possible to use Advanced Settings:</p><ul><li><span class="notranslate"><em>Filename mask</em></span>. It allows to set file type for scanning (for example, <code>*.php</code> – all the files with extension php). Default setting is <code>*</code> which means all files without restriction.</li><li><span class="notranslate"><em>Ignore mask</em></span>. It allows to set file type to ignore (for example, <code>*.html</code> – will ignore all file with extension html).</li><li><span class="notranslate"><em>CPU consumption</em></span>. Defines the CPU consumption for scanning without decreasing efficiency: * from <span class="notranslate">Low</span> to <span class="notranslate">High</span>.</li><li><span class="notranslate"><em>I/O consumption</em></span>. Defines the I/O consumption for scanning without decreasing efficiency: * from <span class="notranslate">Low</span> to <span class="notranslate">High</span>.</li><li><span class="notranslate"><em>Follow symlinks</em></span>. Follow all symlinks within the folder to scan.</li></ul></li></ol><div class="tip custom-block"><p class="custom-block-title">Note</p><p>If Imunify360 is running on CloudLinux OS, LVE is used to manage scan intensity. If it is running on other operating systems, “nice” is used to control CPU and “ionice” is used when the I/O scheduler is CFQ.</p></div><p><img src="'+re+'" alt=""></p><ol><li>Click <span class="notranslate"><em>Start</em></span>.</li></ol><p>At the top right corner Malware Scanner progress and status are displayed:</p><ul><li><span class="notranslate">Scanner is stopped</span> – means that there is no scanning process running.</li><li><span class="notranslate">Scanning…%</span> – means that the scanner is working at the moment. A percentage displays the scanning progress. You can also see the scanning status beneath the <span class="notranslate"><em>Mask</em></span> or <span class="notranslate"><em>Advanced options</em></span>.</li></ul><p><img src="'+ce+'" alt=""></p><p>After <span class="notranslate">Malware Scanner</span> stops on-demand scanning you will see the results in the table below with the following information:</p><ul><li><span class="notranslate"><em>Date</em></span> – the date when the scanning process was started.</li><li><span class="notranslate"><em>Path</em></span> – the name of the folder that was scanned.</li><li><span class="notranslate"><em>Total files</em></span> – the total number of files scanned.</li><li><span class="notranslate"><em>Result</em></span> – the result of scanning.</li><li><span class="notranslate"><em>Actions</em></span> – click icon in this column to perform particular action.</li></ul><p><img src="'+pe+'" alt=""></p><p>To review and manage malicious files go to the <span class="notranslate"><em>Files</em></span> tab described below.</p><div class="notranslate"><h3 id="history" tabindex="-1"><a class="header-anchor" href="#history" aria-hidden="true">#</a> History</h3></div><p><span class="notranslate"><em>History</em></span> tab contains data of all actions for all files. Go to the <span class="notranslate">Imunify360 → History</span> tab. Here, there is a table with a list of files within all domains.</p><p><img src="'+de+'" alt=""></p><p>The table has the following columns:</p><ul><li><span class="notranslate"><strong>Date</strong></span> — action timestamp.</li><li><span class="notranslate"><strong>Path to File</strong></span> — path to the file starting from the root.</li><li><span class="notranslate"><strong>Cause</strong></span> — displays the way malicious file was found: <ul><li><span class="notranslate"><strong>Manual</strong></span> — scanning or cleaning was manually processed by a user.</li><li><span class="notranslate"><strong>On-demand</strong></span> — scanning or cleaning was initiated/made by a user;</li><li><span class="notranslate"><strong>Real time</strong></span> — scanning or cleaning was automatically processed by the system.</li></ul></li><li><span class="notranslate"><strong>Owner</strong></span> — displays a user name of file owner.</li><li><span class="notranslate"><strong>Initiator</strong></span> — displays the name of a user who was initiated the action. For system actions the name is <span class="notranslate"><em>System</em></span>.</li><li><span class="notranslate"><strong>Event</strong></span> — displays the action with the file: <ul><li><span class="notranslate"><strong>Detected as malicious</strong></span> — after scanning the file was detected as infected.</li><li><span class="notranslate"><strong>Cleaned</strong></span> — the file is cleaned up.</li><li><span class="notranslate"><strong>Failed to clean up</strong></span> — there was a problem during cleanup. Hover mouse over the info icon to read more.</li><li><span class="notranslate"><strong>Added to Ignore List</strong></span> — the file was added to the <span class="notranslate">Ignore List</span>. Imunify360 will not scan it.</li><li><span class="notranslate"><strong>Restored original</strong></span> — file content was restored as not malicious.</li><li><span class="notranslate"><strong>Cleanup removed content</strong></span> — file contend was removed after cleanup.</li><li><span class="notranslate"><strong>Deleted from Ignore List</strong></span> — the file was removed from the <span class="notranslate">Ignore List</span>. Imunify360 will scan it.</li><li><span class="notranslate"><strong>Submitted for analysis</strong></span> — the file was submitted to Imunify360 team for analysis.</li><li><span class="notranslate"><strong>Failed to ignore</strong></span> — there was a problem during adding to the <span class="notranslate">Ignore List</span>. Hover mouse over the info icon to read more.</li><li><span class="notranslate"><strong>Failed to delete from ignore</strong></span> — there was a problem during removal from the <span class="notranslate">Ignore List</span>. Hover mouse over the info icon to read more.</li></ul></li></ul><p>The table can be sorted by <span class="notranslate">Date, Path to File, Cause</span>, and <span class="notranslate">Owner</span>.</p><div class="notranslate"><h3 id="ignore-list" tabindex="-1"><a class="header-anchor" href="#ignore-list" aria-hidden="true">#</a> Ignore List</h3></div><p><span class="notranslate">Ignore List</span> tab contains the list of files that are excluded from <span class="notranslate">Malware Scanner</span> scanning. Go to the <span class="notranslate">Imunify360 → Malware Scanner → Ignore List</span> tab. Here, there is a table with a list of files within all domains.</p><p><img src="'+he+'" alt=""></p><p>The table has the following columns:</p><ul><li><span class="notranslate"><strong>Added</strong></span> — the date when the file was added to Ignore List.</li><li><span class="notranslate"><strong>Path</strong></span> — path to the file starting from the root.</li><li><span class="notranslate"><strong>Actions</strong></span>: <ul><li><span class="notranslate"><strong>Remove from Ignore List</strong></span> — click <span class="notranslate"><em>Bin</em></span> symbol <img src="'+me+'" alt=""> to remove the file from the Ignore List and start scanning.</li><li><span class="notranslate"><strong>Add new file or directory</strong></span> — click <span class="notranslate"><em>Plus</em></span> symbol <img src="'+ue+'" alt=""> to add a new file or directory to the <span class="notranslate">Ignore List</span>. In the opened pop-up enter the path to be added and click <span class="notranslate"><em>Add</em></span>.</li></ul></li></ul><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Wildcards are not supported when adding paths to the <span class="notranslate">Ignore List</span>. For example, the following paths are not supported:</p><ul><li><span class="notranslate"><code>/home/*/mail/</code></span></li><li><span class="notranslate"><code>/home/user/*.html</code></span></li><li><span class="notranslate"><code>/home/*</code></span></li></ul></div><p>To perform a bulk action, tick required files and click the corresponding button above the table. The following filters are available:</p><ul><li><span class="notranslate"><strong>Timeframe</strong></span> — displays the results filtered by chosen period or date.</li><li><span class="notranslate"><strong>Items per page</strong></span> — click the number at the table bottom.</li></ul><p>The table can be sorted by <span class="notranslate"><em>Added</em></span> and <span class="notranslate"><em>Path</em></span>. By default, it is sorted from newest to oldest.</p><p>To search file or folder in the <span class="notranslate">Ignore List</span> use <span class="notranslate"><em>Search</em></span> input field above the table.</p>',52),ut=o('<h2 id="proactive-defense" tabindex="-1"><a class="header-anchor" href="#proactive-defense" aria-hidden="true">#</a> Proactive Defense</h2><h3 id="overview" tabindex="-1"><a class="header-anchor" href="#overview" aria-hidden="true">#</a> Overview</h3><p><span class="notranslate">Proactive Defense</span> is a unique Imunify360 feature that can prevent malicious activity through PHP scripts. It is available as a PHP module for Apache and LiteSpeed web servers and analyzes script activity using known patterns like obfuscated command injection, malicious code planting, sending spam, SQL injection etc.</p>',3),gt={class:"tip custom-block"},ft=e("p",{class:"custom-block-title"},"Note",-1),bt=o('<h3 id="user-interface" tabindex="-1"><a class="header-anchor" href="#user-interface" aria-hidden="true">#</a> User Interface</h3><p>Go to <span class="notranslate">Imunify360 → Proactive Defense</span>.</p><p><img src="'+ge+'" alt=""></p><p>Here you can set a mode, view detected events and perform actions on them.</p><p><img src="'+fe+'" alt=""></p><h4 id="mode-settings" tabindex="-1"><a class="header-anchor" href="#mode-settings" aria-hidden="true">#</a> Mode Settings</h4><p>The following <span class="notranslate">Proactive Defense</span> modes are available:</p><ul><li><span class="notranslate">Disabled</span> — means that <span class="notranslate">Proactive Defense</span> feature is not working and a system is not protected enough</li><li><span class="notranslate">Log Only</span> — means that possible malicious activity is only logged, no actions are performed (default mode)</li><li><span class="notranslate">Kill Mode</span> — the highest level of protection — the script is terminated as soon as malicious activity is detected</li></ul><p>To select a mode, tick the desired checkbox. When an action is completed, you will see a pop-up with the successful mode changing message. <img src="'+be+'" alt=""></p><div class="tip custom-block"><p class="custom-block-title">Note</p><ul><li>Data is logged in all modes except <span class="notranslate">Disabled</span>.</li><li>A user can disable <span class="notranslate">Proactive Defense</span> anytime. Any mode that is not disabled (for user’s hosting account) by admin can be activated by user.</li></ul></div><h4 id="detected-events" tabindex="-1"><a class="header-anchor" href="#detected-events" aria-hidden="true">#</a> Detected Events</h4><p>The <span class="notranslate">Detected Events</span> table displays all the necessary information about PHP scripts with malicious activity detected by Imunify360 <span class="notranslate">Proactive Defense</span>. <img src="'+ve+'" alt=""></p><p>You can filter items by time frame in a <span class="notranslate"><em>Timeframe</em></span> dropdown and search a certain entity in a search field.</p><p>The items in the <span class="notranslate"><em>Detected Events</em></span> table are displayed per 25 on a page. To change a number of items displayed, click the number at the bottom right corner <span class="notranslate"><em>Items per page</em></span> and select a desired number in the dropdown.</p><p>To go to the next or the previous page click &gt;&gt; or &lt;&lt; button or click a desired page number.</p><p>The <span class="notranslate"><em>Detected Events</em></span> table includes the following columns:</p><ul><li><span class="notranslate">Group/individual action</span> checkbox — allows to perform actions on one or several desired entities</li><li><span class="notranslate">Detection Date/Time</span> — displays the date and the exact time of event detected. To view the exact time click the clock icon in the desired event line. To order the events from the last to the first or vice versa click the ▲ icon in the <span class="notranslate">Date/Time</span> of detection column header</li><li><span class="notranslate">Description</span> — displays a special Proactive Defense rule according to which a suspicious activity was detected</li><li><span class="notranslate">Script Path</span> — displays the path to the suspicious script. A number near the path describes how many times this event has repeated</li><li><span class="notranslate">Host</span> — displays the host of the script</li><li>First script call from — displays the IP in which the first call of the script was detected. <ul><li>White color means that this IP is whitelisted</li><li>Black color means that this IP is blacklisted</li><li>Gray color means that this IP is graylisted</li><li>All the others IPs are blue colored</li></ul></li><li><span class="notranslate">Action</span> — displays the current mode</li><li><span class="notranslate">Actions</span> — allows to view details and perform actions on the event</li></ul><h4 id="actions" tabindex="-1"><a class="header-anchor" href="#actions" aria-hidden="true">#</a> Actions</h4><p>The following actions are available for the detected event:</p><ul><li>View file content</li><li>Move IP to the <span class="notranslate">Black List</span></li><li>Move file to <span class="notranslate">Ignore List</span> (ignore detected rule) — allows a user to exclude a file from <span class="notranslate">Proactive Defense</span> analysis for a particular rule</li><li>Move file to <span class="notranslate">Ignore List</span> (ignore all rules) — allows a user to exclude a file from <span class="notranslate">Proactive Defense</span> analysis for all rules</li><li>Remove file from <span class="notranslate">Ignore List</span> — allows a user to include ignored file to <span class="notranslate">Proactive Defense</span> analysis again.</li></ul><p><strong>View file content</strong></p><p>This action can be performed in two ways.</p><p><strong>The first way</strong></p><p>Click the <em>View details</em> icon in the row of the desired event. Here you can see the same information as in the table and plus all environment variables and their values. Then, click <span class="notranslate"><em>View file content</em></span> button. The file content will be displayed in a new pop-up.</p><p><img src="'+we+'" alt=""></p><p><strong>The second way</strong> Click <em>Cog</em> icon in the row of the desired event and choose <span class="notranslate"><em>View file content</em></span>.</p><p><img src="'+ye+'" alt=""></p><p>The file content will be displayed in a new pop-up. <img src="'+_e+'" alt=""> The group action is not available for this action.</p><p><strong>Move IP to the Black List</strong></p><p>Click <em>View details</em> icon in the row of the desired event. Then, click <span class="notranslate"><em>Block IP</em></span> button. To move the IP to the Black list click <span class="notranslate"><em>Yes, move to Black list</em></span>. In the pop-up displayed click <span class="notranslate"><em>Yes, move to black list</em></span> to complete the action or <span class="notranslate"><em>Cancel</em></span> to return to the <span class="notranslate"><em>Details</em></span> window. When a file is added to the <span class="notranslate">Black List</span>, you will see the confirmation pop-up.</p><p><img src="'+ke+'" alt=""></p><h4 id="move-file-to-ignore-list-ignore-detected-rule" tabindex="-1"><a class="header-anchor" href="#move-file-to-ignore-list-ignore-detected-rule" aria-hidden="true">#</a> Move file to Ignore List (ignore detected rule)</h4><p><strong>The first way</strong> Click <em>Cog</em> icon in the row of the desired event and choose <span class="notranslate"><em>Ignore detected rule for the file</em></span>. Click <span class="notranslate"><em>Yes, add to Ignore List</em></span> in the confirmation pop-up or click <span class="notranslate"><em>Cancel</em></span> to close pop-up. Now you can see this file on the <span class="notranslate">Ignore List</span> tab. <img src="'+Ie+'" alt=""></p><p><strong>The second way</strong> Click <em>View details</em> icon and then in the file details pop-up click <span class="notranslate"><em>Ignore detected rule for this file</em></span>. Click <span class="notranslate"><em>Yes, add to Ignore List</em></span> in the confirmation pop-up or click <span class="notranslate"><em>Cancel</em></span> to close the pop-up. Now you can see this file on the <span class="notranslate">Ignore List</span> tab.</p><p><img src="'+Pe+'" alt=""></p><h4 id="move-file-to-ignore-list-ignore-all-rules" tabindex="-1"><a class="header-anchor" href="#move-file-to-ignore-list-ignore-all-rules" aria-hidden="true">#</a> Move file to Ignore List (ignore all rules)</h4><p><strong>The first way</strong> Click <em>Cog</em> icon in the row of the desired event and choose <span class="notranslate"><em>Ignore all rules for the file</em></span>. Click <span class="notranslate"><em>Yes, add to Ignore List</em></span> in the confirmation pop-up or click <span class="notranslate"><em>Cancel</em></span> to close pop-up. The file will be moved to <span class="notranslate">Ignore List</span> tab. <img src="'+xe+'" alt=""></p><p><strong>The second way</strong> Click <em>View details</em> icon and then in the file details pop-up click <span class="notranslate"><em>Ignore all rules for this file</em></span>. Click <span class="notranslate"><em>Yes, add to Ignore List</em></span> in the confirmation pop-up or click <span class="notranslate"><em>Cancel</em></span> to close the pop-up. Now you can see this file on the <span class="notranslate">Ignore List</span> tab.</p><p><img src="'+Se+'" alt=""></p><p><strong>Remove file from Ignore List</strong></p><p>On the Ignore List tab click <em>Bin</em> icon and confirm the action. <img src="'+Ce+'" alt=""></p><p>To perform bulk action, tick required checkboxes and click <span class="notranslate"><em>Remove from ignore list</em></span> at the top of the table, then confirm the action in the pop-up.</p><p><strong>Ignore List tab</strong></p><p>Here, there is a table with files with ignored rules. If file is added to <span class="notranslate">Ignore List, Proactive Defense</span> will not analyze scripts activity from this file for all or specified rule. <img src="'+Te+'" alt=""></p><p>The <span class="notranslate"><em>Ignore List</em></span> table includes the following columns:</p><ul><li><span class="notranslate">Add Date/Time</span> — displays the date and the exact time of adding a file. To view the exact time click the clock icon in the desired file line. To order the files from the last to the first or vice versa click the ▲ icon in the <span class="notranslate">Add Date/Time</span> column header.</li><li><span class="notranslate">Script Path</span> — displays the path to the script.</li><li><span class="notranslate">Rules to ignore</span> — displays the pattern to be ignored.</li><li><span class="notranslate">Actions</span> — allows to view details and perform actions on the file.</li></ul>',46),vt=o(`<h4 id="how-to-test-proactive-defense" tabindex="-1"><a class="header-anchor" href="#how-to-test-proactive-defense" aria-hidden="true">#</a> How to test Proactive Defense</h4><ol><li>Set <span class="notranslate">Proactive Defense</span> to <span class="notranslate"><em>Log only</em></span> mode (requests will not be blocked) or to <span class="notranslate"><em>Kill mode</em></span> to kill all requests.</li><li>Add the following row in order to enable test mode rules:</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>echo &#39;check_mode = -10&#39; &gt;&gt; /usr/share/i360-php-opts/module.ini
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><ol start="3"><li>Create a file with the following content:</li></ol><div class="notranslate"><div class="language-PHP line-numbers-mode" data-ext="PHP"><pre class="language-PHP"><code>&lt;?php
$pattern = &#39;TEST-FILE&#39;;
$external_code = @file_get_contents(&#39;https://secure.eicar.org/eicar.com.txt&#39;);
if (strpos($external_code,$pattern)){
    print &quot;Poactive Defence DOESN&#39;T work or NOT in KILL mode&quot;;
}
else {
    print &quot;Proactive Defence works fine - file_get_contents function has been BLOCKED, please check Imunify360 Proactive Defence tab for corresponding BLOCK event&quot;;
}
?&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>This script is available starting from Imunify360 v. 4.10.2<br> This script will only check for PD if file_get_contents is not disabled and allow_url_fopen is enabled in the PHP settings on the server.</p></div><ol start="4"><li>Place this file on the server.</li><li>Call a test page with the script from the point 2.</li><li>If <span class="notranslate">Proactive Defense</span> is disabled, you will see &quot;PD doesn&#39;t work or not in KILL mode&quot; message after calling the script and no records will appear in &quot;Incident&quot; tab.</li><li>If <span class="notranslate">Proactive Defense</span> is enabled and <span class="notranslate"><em>Log only</em></span> mode is set, you will see &quot;PD doesn&#39;t work or not in KILL mode&quot; message after calling the script and a new event with description &quot;Blamer detection&quot; in the <span class="notranslate"><em>Detected Events</em></span> table with &quot;LOG&quot; action.</li><li>If <span class="notranslate">Proactive Defense</span> is enabled and <span class="notranslate"><em>Kill mode</em></span> is set, the test page returns an error.And a new event with description &quot;Blamer detection&quot; in the <span class="notranslate"><em>Detected Events</em></span> table with &quot;KILL&quot; action.</li><li>Remove the following row from the <span class="notranslate"><code>/usr/share/i360-php-opts/module.ini</code></span> in order to disable test mode rules</li></ol><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>check_mode = -10
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>the number of triggered rule is 77777 and it is possible to check it via CLI</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent proactive list
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div></div><h4 id="opcache-jit-in-php8-and-the-proactive-defense-module" tabindex="-1"><a class="header-anchor" href="#opcache-jit-in-php8-and-the-proactive-defense-module" aria-hidden="true">#</a> opcache.jit in PHP8 and the Proactive Defense module</h4><p>Starting from PHP 8, the interpreter supports <code>opcache.jit</code> option to enable just-in-time compilation of the code.</p><p>When the <span class="notranslate">Proactive Defense</span> extension (or any other PHP extensions that use the hooks to intercept function calls) is enabled, opcache engine disables <code>opcache.jit</code> automatically and reports it into the error log. It does not affect the stability and performance of websites running PHP 8 when both <code>opcache.jit</code> and the <span class="notranslate">Proactive Defense</span> module are enabled, but the JIT will be off.</p><p>To keep <code>opcache.jit</code> forcibly enabled and keep the <span class="notranslate">Proactive Defense</span> module enabled, one needs to add the following config option:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>jit_compatible_mode=on
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>in the <code>/usr/share/i360-php-opts/module.ini</code> file.</p><h2 id="reputation-management" tabindex="-1"><a class="header-anchor" href="#reputation-management" aria-hidden="true">#</a> Reputation Management</h2><p>Choose <span class="notranslate"><em>Reputation Management</em></span> in the main menu of the Imunify360 admin interface to get to the <span class="notranslate">Reputation Management</span> page.</p><p><span class="notranslate">Reputation Management</span> allows to check if a domain registered on your server is safe or not based on the following reputation engines:</p><ul><li><a href="https://safebrowsing.google.com/" target="_blank" rel="noopener noreferrer">Google Safe Browsing</a></li><li><a href="https://tech.yandex.com/safebrowsing/" target="_blank" rel="noopener noreferrer">Yandex Safe Browsing</a></li><li><a href="https://www.spamhaus.org/" target="_blank" rel="noopener noreferrer">Spamhaus</a></li><li><a href="https://www.phishtank.com/" target="_blank" rel="noopener noreferrer">PhishTank</a></li><li><a href="https://openphish.com/" target="_blank" rel="noopener noreferrer">OpenPhish</a>.</li></ul><p>How does it work:</p><ul><li>We get a list of domains periodically (via crontab)</li><li>Send it to the central Imunify360 server</li><li>Get results from it</li><li>Add bad domains to the list of <span class="notranslate">Reputation Management</span></li></ul><p>If a domain or an IP is blocked, then this information will be available in the table below. If a user’s website appears in this table, then it would be useful to send <a href="https://developers.google.com/webmasters/hacked/" target="_blank" rel="noopener noreferrer">this link</a> to the user. This instruction can help to solve problems with the domain.</p><p>At the top of the page (also in the main menu near <span class="notranslate">Reputation Management</span> item), Imunify360 shows the number of affected domains. This number is a quantity of affected domains that exist on the server.</p><p>The table shows:</p><ul><li><span class="notranslate"><em>ID</em></span> – domain owner username</li><li><em>URL</em> – the affected domain link</li><li><span class="notranslate"><em>Type</em></span> – read more about types <a href="https://developers.google.com/safe-browsing/v4/reference/rest/v4/ThreatType" target="_blank" rel="noopener noreferrer">on the link</a> (we still do not support <span class="notranslate">THREAT_TYPE_UNSPECIFIED</span> and <span class="notranslate">POTENTIALLY_HARMFUL_APPLICATION</span>).</li><li><span class="notranslate"><em>Detection time</em></span> – exact time when the <span class="notranslate">Reputation Management</span> has detected the domain</li></ul><p><img src="`+De+'" alt=""></p><p>Click link icon in the <span class="notranslate"><em>Action</em></span> column to copy the URL to the clipboard.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p><span class="notranslate">Reputation Management</span> online and browser look may differ. This is because Google Safe Browsing has an issue described on github.</p></div><h2 id="kernelcare-integration" tabindex="-1"><a class="header-anchor" href="#kernelcare-integration" aria-hidden="true">#</a> KernelCare Integration</h2>',29),wt=e("a",{href:"https://www.kernelcare.com",target:"_blank",rel:"noopener noreferrer"},"KernelCare",-1),yt=e("span",{class:"notranslate"},[e("em",null,"Install KernelCare")],-1),_t=o('<p><img src="'+Ae+'" alt=""></p><p>To observe current KernelCare status in the Imunify360 main menu choose <em>KernelCare</em> tab.</p><p>Here you can check:</p><ul><li><span class="notranslate">Effective Kernel Version</span> – version of the kernel that KernelCare enable on the server</li><li><span class="notranslate">Real Kernel Version</span> – real version of the kernel</li><li><span class="notranslate">Update mode</span> – auto updated mode On or Off</li><li><span class="notranslate">Uptime</span> – uptime of the kernel in days</li></ul><p>To disable auto update mode toggle the <span class="notranslate"><code>Update mode</code></span> switch to <span class="notranslate"><code>No</code></span>.</p><p><img src="'+Me+'" alt=""></p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>If you have KernelCare license(s) on the same server(s), then cancel this license in CLN because KernelCare will be free for that server. If you do not know how to cancel licenses then follow <a href="https://www.cloudlinux.com/getting-started-with-cloudlinux-os/43-getting-more-information/938-billing-faq#8" target="_blank" rel="noopener noreferrer">this link</a> for details.</p></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>KernelCare tab can load slowly on highly loaded systems.</p></div><p>Read more about KernelCare <a href="https://www.kernelcare.com" target="_blank" rel="noopener noreferrer">on the link</a>.</p><h2 id="settings" tabindex="-1"><a class="header-anchor" href="#settings" aria-hidden="true">#</a> Settings</h2><p>Choose <span class="notranslate"><em>Settings</em></span> in the main menu to get to the Imunify360 settings page. The following tabs are available:</p>',11),kt={class:"notranslate"},It={class:"notranslate"},Pt={class:"notranslate"},xt={class:"notranslate"},St={class:"notranslate"},Ct={class:"notranslate"},Tt=e("h3",{id:"general",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#general","aria-hidden":"true"},"#"),a(" General")],-1),Dt=e("p",null,[a("Go to "),e("span",{class:"notranslate"},[e("em",null,"Imunify360 → Settings → General")]),a(". The following sections are available:")],-1),At={class:"notranslate"},Mt={class:"notranslate"},Lt={class:"notranslate"},qt={class:"notranslate"},Nt={class:"notranslate"},Ht={class:"notranslate"},Bt={class:"notranslate"},Ft={class:"notranslate"},Rt={class:"notranslate"},Et={class:"notranslate"},Wt={class:"notranslate"},Ot={class:"notranslate"},Gt={class:"notranslate"},Ut=e("h4",{id:"installation",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#installation","aria-hidden":"true"},"#"),a(" Installation")],-1),Yt=e("p",null,"Here you can install and uninstall the following components:",-1),zt=e("ul",null,[e("li",null,"HardenedPHP"),e("li",null,"KernelCare")],-1),jt=e("img",{src:Le,alt:""},null,-1),Kt=o('<h4 id="hardenedphp" tabindex="-1"><a class="header-anchor" href="#hardenedphp" aria-hidden="true">#</a> HardenedPHP</h4><p>To install or uninstall HardenedPHP click on a button related. Please find additional information about HardenedPHP in <a href="https://docs.cloudlinux.com/cloudlinux_os_components/#php-selector" target="_blank" rel="noopener noreferrer">this article</a>. During HardenedPHP installation process the installation log will appear and will update automatically.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>HardenedPHP is free on the servers with Imunify360 installed.</p></div><p><img src="'+qe+'" alt=""></p><h4 id="kernelcare" tabindex="-1"><a class="header-anchor" href="#kernelcare" aria-hidden="true">#</a> KernelCare</h4><p>To install or uninstall KernelCare click on a button related. Please find additional information about KernelCare <a href="https://www.kernelcare.com" target="_blank" rel="noopener noreferrer">here</a>.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>KernelCare is free on the servers with Imunify360 installed.</p></div>',7),Vt={id:"privilege-escalation-detection-protection",tabindex:"-1"},Jt=e("a",{class:"header-anchor",href:"#privilege-escalation-detection-protection","aria-hidden":"true"},"#",-1),Qt=e("div",{class:"warning custom-block"},[e("p",{class:"custom-block-title"},"Warning!"),e("p",null,"This feature is deprecated.")],-1),$t=e("p",null,"The KernelCare extension for Imunify360 allows tracing malicious invocations to detect privilege escalation attempts.",-1),Xt=e("code",null,"EDF",-1),Zt=o('<p>To enable the feature, tick the <span class="notranslate"><em>Privilege escalation detection &amp; protection</em></span> checkbox.</p><p><img src="'+Ne+`" alt=""></p><div class="warning custom-block"><p class="custom-block-title">Note</p><p>The <em>Privilege escalation detection &amp; protection</em> feature is implemented for CentOS 7 only.</p></div><p>Or you can enable it via CLI using the following command:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;KERNELCARE&quot;: {&quot;edf&quot;: true}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>Click <span class="notranslate"><em>Save changes</em></span> button on the bottom of the section to save changes.</p><h4 id="waf-settings" tabindex="-1"><a class="header-anchor" href="#waf-settings" aria-hidden="true">#</a> WAF Settings</h4><p>When the <span class="notranslate"><em>Minimized ModSec Ruleset</em></span> option is on, it disables Imunify WAF rules with a high memory footprint, yet leaves critical ruleset enabled. It is recommended for the servers with a small amount of RAM. It is enabled by default for the installations with low RAM.</p><p>You can switch back to the normal mode by enabling WebShield or unchecking <span class="notranslate"><em>Minimized ModSec Ruleset</em></span> in Settings | General | WAF Settings</p><p><img src="`+He+'" alt=""></p><p>Click <span class="notranslate"><em>Save changes</em></span> button on the bottom of the section to save changes.</p><h4 id="wordpress-account-brute-force-protection" tabindex="-1"><a class="header-anchor" href="#wordpress-account-brute-force-protection" aria-hidden="true">#</a> WordPress Account Brute-force Protection</h4><p>Server admin can enable an option to prevent access to WordPress accounts with well-known (trivial) passwords. When the option is enabled, all end-users that are trying to log into the admin account with weak/trivial or well-known passwords from the dictionary used by brute-forcers will be taken to the special alert page with an appeal to change their current password.</p>',13),es=e("span",{class:"notranslate"},[e("code",null,"cms_account_compromise_prevention"),a(" to "),e("code",null,"true")],-1),as={class:"tip custom-block"},ts=e("p",{class:"custom-block-title"},"Note",-1),ss=o('<p><img src="'+Be+'" alt=""><img src="'+Fe+'" alt=""></p><p>The alert page supports localization and is displayed in the language of the browser (on an external Imunify domain).</p><h4 id="cms-specific-waf-rules" tabindex="-1"><a class="header-anchor" href="#cms-specific-waf-rules" aria-hidden="true">#</a> CMS-specific WAF Rules</h4><p>WAF Rules Auto-Configurator generates a set of rules on a per-domain basis, considering the Content Management System (CMS), that the website is running (WordPress, Joomla, Drupal etc).</p><p>It allows making WAF rules more effective to protect websites and reduce the number os false positives.</p><p>It works in the background and scans domains for installed CMS daily, after that rebuilds ModSec configuration based on detected software.</p><p><img src="'+Re+`" alt=""></p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>This feature is only available for the Apache 2.4 web server</p></div><h4 id="dos-protection" tabindex="-1"><a class="header-anchor" href="#dos-protection" aria-hidden="true">#</a> DoS Protection</h4><p><span class="notranslate">DoS Protection</span> section allows to enable or disable DoS protection. DoS protection works by counting connections from each remote IP address per local port separately. To enable/disable it, tick the <span class="notranslate"><em>Enable Dos Protection</em></span> checkbox. Or you can enable it using the following CLI command:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;DOS&quot;: {&quot;enabled&quot;: true}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>It is possible to configure how Imunify360 will behave:</p>`,12),ns=e("li",null,[e("span",{class:"notranslate"},[e("em",null,"Max Connections")]),a("– allows to setup the number of simultaneous connections allowed before IP will be blocked. Cannot be set lower than 100.")],-1),os=e("span",{class:"notranslate"},[e("em",null,"Check delay")],-1),is=o('<p><strong>The minimum values</strong>:</p><ul><li>Max Connections = 100</li><li>Check delay = 30</li></ul><div class="tip custom-block"><p class="custom-block-title">Note</p><p><em>Check delay</em> is limited by the minimum value of 30, lower values can cause &quot;false positives&quot; triggering.</p></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Although DoS protection works on the TCP level, it is not the same as http request rate - even if there is large number of http connections, the number of TCP connections can be relatively low.</p></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Imunify360 DoS protection is automatically disabled if CSF is active - a warning is shown in Imunify360 UI in that case</p></div><p><img src="'+Ee+'" alt=""></p><p>Click <span class="notranslate"><em>Save changes</em></span> button on the bottom of the section to save changes.</p><h4 id="enhanced-dos-protection" tabindex="-1"><a class="header-anchor" href="#enhanced-dos-protection" aria-hidden="true">#</a> Enhanced DOS Protection</h4>',8),ls=o(`<p>The new feature works better against attacks based on short-living connections and against attacks where the number of requests grows fast (hundreds of requests per second). As Enhanced DOS Protection monitors the number of requests in real-time, it reacts to the threats almost instantly, greylisting the detected IPs and redirecting their requests to the Anti-Bot challenge.</p><p>Standard DoS protection, in turn, will block attacks that use long-lived connections (e.g. Slowloris attacks), so these functions complement each other perfectly.</p><p>You can find all incidents related to the new feature in the incidents table by the description:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>“Denial of Service (DoS) attack was discovered from %IP%: %threshold% connections per %timeframe% seconds to %port% port”.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4>Activating and fine-tuning Enhanced DOS Protection</h4><p>The feature is switched off by default. You can activate Enhanced DOS Protection in Imunify360 using the following CLI command:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;ENHANCED_DOS&quot;:{&quot;enabled&quot;:true}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The default timeframe (seconds) and threshold of request (number) could be changed by the following CLI commands:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;ENHANCED_DOS&quot;:{&quot;timeframe&quot;:60}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;ENHANCED_DOS&quot;:{&quot;default_limit&quot;:500}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Request limits for different ports could be set separately, using the following CLI commands:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;ENHANCED_DOS&quot;: {&quot;port_limits&quot;: {&quot;80&quot;: 150}}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>We also recommend checking and configuring the CAPTCHA_DOS section of <a href="/config_file_description">parameters</a> to blacklist IPs after repetitive requests to the captcha.</p><h4 id="smtp-traffic-manager" tabindex="-1"><a class="header-anchor" href="#smtp-traffic-manager" aria-hidden="true">#</a> SMTP Traffic Manager</h4><p>SMTP traffic management provides more control over SMTP traffic.</p><p>An administrator can redirect mail traffic to the local MTA, block it completely, or keep it available for local mails only. Administrators can also block particular ports and whitelist specific users or groups for outgoing mail.</p><p>This feature extends the existing cPanel <span class="notranslate">“Block SMTP”</span> functionality, albeit with more control and capabilities, and replaces the similar functionality from CSF.</p><p>You can enable the <span class="notranslate">SMTP Traffic Management</span> in the <span class="notranslate">Settings</span>:</p><p><img src="`+We+`" alt=""></p><ul><li><span class="notranslate"><strong>SMTP ports</strong></span> - a list of the ports to be blocked. The defaults are: 25, 587,465</li><li><span class="notranslate"><strong>Allow users</strong></span> a list of the users to be ignored (not blocked). By default it is empty. Including Unix and CPanel users (if a process that sends an email has a UID of one of the <span class="notranslate"><code>allow_users</code></span>, it will not be blocked)</li><li><span class="notranslate"><strong>Allow groups</strong></span> - a list of the groups to be ignored (not blocked). By default it is empty. Including Unix and CPanel users (if a process that sends an email has a UID of one of the <span class="notranslate"><code>allow_users</code></span>, it will not be blocked)</li><li><span class="notranslate"><strong>Allow local</strong></span> - block all except the local SMTP (localhost). By default it is disabled.</li><li><span class="notranslate"><strong>Redirect to local</strong></span> - enable automatic redirection to the local ports for outgoing mail traffic. By default it is disabled.</li></ul><div class="warning custom-block"><p class="custom-block-title"></p><p>Note that the term &quot;group&quot; here means the primary group of UNIX users.</p><p>For example, we have a user &quot;john&quot; whose primary group is &quot;john&quot; and the supplementary group is &quot;admin&quot;:</p><ul><li>If you add a rule for the group &quot;john&quot;, it&#39;d match (the user would be allowed to send emails).</li><li>If a rule is added for the group &quot;admin&quot;, it wouldn&#39;t match (the user would be denied sending emails) because &quot;admin&quot; isn&#39;t a primary group of user &quot;john&quot;.</li></ul></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>The following is added by default into the <em>Allow users</em> and the <em>Allow groups</em> for cPanel:</p><ul><li>UIDs - 0 (root), 202 (cpanel)</li><li>GIDs - 12 (mail)</li></ul></div><p>To enable these settings via direct config file update or a command-line interface, use this command:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;SMTP_BLOCKING&quot;: {&quot;allow_local&quot;: true, &quot;enable&quot;: true}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>The config file should show:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SMTP_BLOCKING:
 allow_groups:
 - mailacc
 allow_local: true
 allow_users: []
 enable: true
 ports:
 - 25
 - 587
 - 465
 redirect: true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h4 id="what-if-the-conflict-with-whm-smtp-restrictions-message-is-shown" tabindex="-1"><a class="header-anchor" href="#what-if-the-conflict-with-whm-smtp-restrictions-message-is-shown" aria-hidden="true">#</a> What if the Conflict with WHM &gt;&gt; SMTP Restrictions message is shown?</h4><p><img src="`+Oe+'" alt=""></p><p><span class="notranslate"><em>WHM SMTP Restrictions</em></span> requires to be disabled at the cPanel to get <span class="notranslate"><em>SMTP Traffic Management</em></span> working.</p><p>To disable it, log in to the cPanel WHM portal, select <span class="notranslate"><em>SMTP Restrictions</em></span> on the left sidebar and disable it.</p><h4 id="_3-rd-party-integration" tabindex="-1"><a class="header-anchor" href="#_3-rd-party-integration" aria-hidden="true">#</a> 3-rd Party Integration</h4><p>Tick the <span class="notranslate"><em>Manage CSF Events and Lists</em></span> checkbox to enable/disable the integration between CSF and Imunify360.</p><p><img src="'+Ge+'" alt=""></p>',33),rs=o('<h4 id="auto-white-list" tabindex="-1"><a class="header-anchor" href="#auto-white-list" aria-hidden="true">#</a> Auto White List</h4><p><span class="notranslate">Auto White List</span> section allows to automatically add admin IP to the <span class="notranslate">White List</span> each time when he logs in to hosting panel and enters Imunify360 admin interface. In <span class="notranslate"><em>Timeout</em></span> field enter the number of minutes – the IP will be removed from the white list automatically after this time.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>0 means adding IP to the <span class="notranslate">White List</span> permanently.</p></div><p><img src="'+Ue+'" alt=""></p><p>Click <span class="notranslate"><em>Save changes</em></span> button on the bottom of the section to save changes.</p><h4 id="incidents-logging" tabindex="-1"><a class="header-anchor" href="#incidents-logging" aria-hidden="true">#</a> Incidents Logging</h4>',6),cs=o('<p>There are 15 available levels related to <a href="https://www.ossec.net/docs/manual/rules-decoders/rule-levels.html" target="_blank" rel="noopener noreferrer">OSSEC</a> and <a href="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#severity" target="_blank" rel="noopener noreferrer">ModSecurity</a> severity levels:</p><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td>Log level</td><td>ModSecurity</td><td>OSSEC</td></tr><tr><td>1</td><td>7 – <span class="notranslate">DEBUG</span></td><td>01 – None</td></tr><tr><td>2</td><td>6 – <span class="notranslate">INFO</span></td><td>02 – System low priority notification</td></tr><tr><td>3</td><td>5 – <span class="notranslate">NOTICE</span></td><td>03 – Successful/Authorized events</td></tr><tr><td>4</td><td>4 – <span class="notranslate">WARNING</span></td><td>04 – System low priority error</td></tr><tr><td>5</td><td>4 – <span class="notranslate">WARNING</span></td><td>05 – User generated error</td></tr><tr><td>6</td><td>3 – <span class="notranslate">ERROR</span></td><td>06 – Low relevance attack</td></tr><tr><td>7</td><td>3 – <span class="notranslate">ERROR</span></td><td>07 – “Bad word” matching.</td></tr><tr><td>8</td><td>3 – <span class="notranslate">ERROR</span></td><td>08 – First time seen</td></tr><tr><td>9</td><td>3 – <span class="notranslate">ERROR</span></td><td>09 – Error from invalid source</td></tr><tr><td>10</td><td>3 – <span class="notranslate">ERROR</span></td><td>10 – Multiple user generated errors</td></tr><tr><td>11</td><td>3 – <span class="notranslate">ERROR</span></td><td>11 – Integrity checking warning</td></tr><tr><td>12</td><td>2 – <span class="notranslate">CRITICAL</span></td><td>12 – High importancy event</td></tr><tr><td>13</td><td>2 – <span class="notranslate">CRITICAL</span></td><td>13 – Unusual error (high importance)</td></tr><tr><td>14</td><td>1 – <span class="notranslate">ALERT</span></td><td>14 – High importance security event.</td></tr><tr><td>15</td><td>0 – <span class="notranslate">EMERGENCY</span></td><td>15 – Severe attack</td></tr></tbody></table><p>Autocleanup configuration allows to keep the <span class="notranslate">Incidents</span> page clean by default. The possible settings are as follows:</p><ul><li><span class="notranslate"><em>Keep incidents for the last days</em></span> – set the number of days Imunify360 will keep the incidents</li><li><span class="notranslate"><em>Keep maximum incidents count</em></span> – set maximum quantity of the incidents to keep on the server</li><li><span class="notranslate"><em>Auto-refresh time for Incidents page</em></span> – set <span class="notranslate">Incidents</span> page auto-refresh time in seconds</li></ul><p><img src="'+Ye+'" alt=""></p><p>Click <span class="notranslate"><em>Save changes</em></span> button on the bottom of the section to save changes.</p><h4 id="webshield" tabindex="-1"><a class="header-anchor" href="#webshield" aria-hidden="true">#</a> WebShield</h4><p><img src="'+ze+`" alt=""></p><ul><li><p><span class="notranslate"><em>Enable WebShield</em></span>. When the option is off, disable WebShield, GreyList, and Anti-bot Challenge. A disabled state is recommended for servers with a small amount of RAM. A disabled option along with enabled &quot;Minimized WAF Ruleset&quot; will switch Imunify360 to the &quot;Low Resource Usage&quot; mode.</p></li><li><p><span class="notranslate"><em>Detect IPs behind CDN</em></span> feature allows to recognize and block IPs with suspicious activity behind supported CDN providers.</p><p>To enable/disable it, tick the <span class="notranslate"><em>Detect IPs behind CDN</em></span> checkbox.</p><p>Or you can enable it using the following CLI command:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;WEBSHIELD&quot;: {&quot;known_proxies_support&quot;: true}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>Supported CDN providers:</p><ul><li>Cloudflare</li><li>MaxCDN</li><li>StackPath CDN</li><li>KeyCDN</li><li>Dartspeed.com</li><li>QUIC.cloud CDN</li></ul></li></ul><p>Click <span class="notranslate"><em>Save changes</em></span> button on the bottom of the section to save changes.</p><h4 id="anti-bot-protection" tabindex="-1"><a class="header-anchor" href="#anti-bot-protection" aria-hidden="true">#</a> Anti-bot protection</h4><p>Tick the <span class="notranslate"><em>Anti-bot protection</em></span> checkbox to enable the JavaScript challenge – &quot;Splash Screen.&quot;</p>`,12),ps=o('<p><img src="'+je+'" alt=""></p><p>Click <span class="notranslate"><em>Save changes</em></span> button on the bottom of the section to save changes.</p><h4 id="cpanel-account-protection" tabindex="-1"><a class="header-anchor" href="#cpanel-account-protection" aria-hidden="true">#</a> cPanel account protection</h4><p>Tick the checkbox next to the <span class="notranslate"><em>cPanel account protection</em></span> option to enable the JavaScript challenge for users trying to access the cPanel interface.</p>',4),ds=o('<p><img src="'+Ke+'" alt=""></p><h4 id="ossec" tabindex="-1"><a class="header-anchor" href="#ossec" aria-hidden="true">#</a> OSSEC</h4><p>Tick the <span class="notranslate"><em>Active response</em></span> checkbox to block access to a specific server port being attacked. The purpose of the feature is to significantly reduce the false-positive rate while increasing its capabilities to detect and block aggressive brute-force requests.</p><p><img src="'+Ve+'" alt=""></p><p>Click <span class="notranslate"><em>Save changes</em></span> button on the bottom of the section to save changes.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>For now, the feature covers the following ports:</p><ul><li>FTP - 21 port,</li><li>SSH - 22 port, and any other one manually defined starting from version 5.7</li><li>SMTP - 25, 465, 587 ports</li></ul></div><h4 id="pam" tabindex="-1"><a class="header-anchor" href="#pam" aria-hidden="true">#</a> PAM</h4><h4 id="pam-brute-force-attack-protection" tabindex="-1"><a class="header-anchor" href="#pam-brute-force-attack-protection" aria-hidden="true">#</a> PAM brute-force attack protection</h4><p>Tick the <span class="notranslate"><em>PAM brute-force attack protection</em></span> checkbox to enable an advanced brute-force protection technique based on the combination of PAM module authorization, RBL check, and IP blacklisting.</p><p><img src="'+Je+`" alt=""></p><p>You can also enable it via CLI with the following command:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;PAM&quot;: {&quot;enable&quot;: true}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>Click <span class="notranslate"><em>Save changes</em></span> button at the bottom of the section to apply changes. This will enable protection for SSH/FTP protocols.</p><h4 id="exim-dovecot-brute-force-attack-protection" tabindex="-1"><a class="header-anchor" href="#exim-dovecot-brute-force-attack-protection" aria-hidden="true">#</a> Exim+Dovecot brute-force attack protection</h4><div class="tip custom-block"><p class="custom-block-title">Note</p><p>This protection type is available only in cPanel/WHM.</p></div><p>Tick the <span class="notranslate"><em>Exim+Dovecot brute-force attack protection</em></span> checkbox to enable advanced protection against Dovecot brute-force attacks. PAM module protects against IMAP/POP3 brute-force attacks and prevents mail accounts from being compromised via brute-forcing.</p><p><img src="`+Qe+`" alt=""></p><p>You can also enable it via CLI with the following command:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;PAM&quot;: {&quot;exim_dovecot_protection&quot;: true}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>Click <span class="notranslate"><em>Save changes</em></span> button at the bottom of the section to apply changes.</p><h4 id="ftp-brute-force-attack-protection" tabindex="-1"><a class="header-anchor" href="#ftp-brute-force-attack-protection" aria-hidden="true">#</a> FTP brute-force attack protection</h4><div class="tip custom-block"><p class="custom-block-title">Note</p><p>This protection type is available only in cPanel/WHM for the proftpd and pureftpd daemons.</p></div><p>Tick the <span class="notranslate"><em>FTP brute-force attack protection</em></span> checkbox to enable protection for the ftpd server against FTP brute-force attacks. It uses a time-proven algorithm that we’ve been using in the SSH PAM extension.</p><p><img src="`+$e+`" alt=""></p><p>You can also enable it via CLI with the following command:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;PAM&quot;: {&quot;ftp_protection&quot;: true}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>Click <span class="notranslate"><em>Save changes</em></span> button on the bottom of the section to save changes. This will enable protection for SSH/FTP protocols.</p><h4 id="error-reporting" tabindex="-1"><a class="header-anchor" href="#error-reporting" aria-hidden="true">#</a> Error Reporting</h4><p>Tick <span class="notranslate"><em>Enable Sentry error reporting</em></span> checkbox to send reports to the Imunify360 error reports server.</p><p><img src="`+Xe+'" alt=""></p><p>Click <span class="notranslate"><em>Save changes</em></span> button on the bottom of the section to save changes.</p><h4 id="contact-details" tabindex="-1"><a class="header-anchor" href="#contact-details" aria-hidden="true">#</a> Contact Details</h4><p>Type your email into the <span class="notranslate"><em>Email</em></span> field to receive email reports about critical issues, security alerts or system misconfigurations detected on your servers.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>This email address is used ONLY for receiving server reports.</p></div><p><img src="'+Ze+'" alt=""></p><p>Click <span class="notranslate"><em>Save changes</em></span> button at the bottom of the section to save changes.</p><h3 id="malware" tabindex="-1"><a class="header-anchor" href="#malware" aria-hidden="true">#</a> Malware</h3><p>Go to the <em>Imunify360 → Settings → Malware</em>. The following sections are available:</p><p>Here you can configure the following:</p>',39),hs=e("span",{class:"notranslate"},"Resource consumption",-1),ms=e("span",{class:"notranslate"},"General",-1),us=e("span",{class:"notranslate"},"Background Scanning",-1),gs=e("span",{class:"notranslate"},"Cleanup",-1),fs=e("span",{class:"notranslate"},"Proactive Defense",-1),bs=e("span",{class:"notranslate"},"Malware Database Scanner",-1),vs={class:"tip custom-block"},ws=e("p",{class:"custom-block-title"},"Note",-1),ys=o('<h4 id="resource-consumption" tabindex="-1"><a class="header-anchor" href="#resource-consumption" aria-hidden="true">#</a> Resource consumption</h4><p><img src="'+ea+'" alt=""></p><ul><li><p><span class="notranslate"><em>CPU consumption</em></span> – allows setting a level of CPU usage by Malware Scanner.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Low CPU usage means low scanning speed</p></div></li><li><p><span class="notranslate"><em>I/O consumption</em></span> – allows setting a level of I/O usage by Malware Scanner.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Low I/O usage means low scanning speed</p></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>If Imunify360 is running on CloudLinux OS, LVE is used to manage scan intensity. If it is running on other operating systems, “nice” is used to control the CPU and “ionice” is used when the I/O scheduler is CFQ.</p></div></li></ul><h4 id="general-1" tabindex="-1"><a class="header-anchor" href="#general-1" aria-hidden="true">#</a> General</h4><p><img src="'+aa+'" alt=""></p>',5),_s=o('<li><p><span class="notranslate"><em>Automatically scan all modified files</em></span> – enables real-time scanning for modified files using <a href="https://en.wikipedia.org/wiki/Inotify" target="_blank" rel="noopener noreferrer">inotify</a> library. The Scanner searches for modified files in user’s DocumentRoot directories.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>It requires inotify to be installed and may put an additional load on a system.</p></div></li><li><p><span class="notranslate"><em>Optimize real-time scan</em></span> – enables the <a href="https://docs.cloudlinux.com/cloudlinux_os_kernel/#file-change-api" target="_blank" rel="noopener noreferrer">File Change API</a> and <strong>fanotify</strong> support to reduce the system load while watching for file changes in comparison with inotify watchs.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>File change API can work only with ext4 file system.</p></div><table><thead><tr><th></th><th style="text-align:center;"></th><th style="text-align:center;"></th><th style="text-align:center;"></th></tr></thead><tbody><tr><td></td><td style="text-align:center;"><strong>inotify</strong></td><td style="text-align:center;"><strong>fanotify</strong></td><td style="text-align:center;"><strong>File change API</strong></td></tr><tr><td>CentOS 6</td><td style="text-align:center;">✓</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td></tr><tr><td>CentOS 7</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td><td style="text-align:center;">x</td></tr><tr><td>CentOS 8 / AlmaLinux 8</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td><td style="text-align:center;">x</td></tr><tr><td>CloudLinux OS 6</td><td style="text-align:center;">✓</td><td style="text-align:center;">x</td><td style="text-align:center;">x</td></tr><tr><td>CloudLinux OS 7</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td></tr><tr><td>CloudLinux OS 7 hybryd</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓ (6.8+)</td></tr><tr><td>CloudLinux OS 8</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td></tr><tr><td>CloudLinux OS Solo</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td><td style="text-align:center;">x</td></tr><tr><td>Ubuntu 16.04 / Debian 9</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td><td style="text-align:center;">x</td></tr><tr><td>Ubuntu 18.04 / Debian 10</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td><td style="text-align:center;">x</td></tr><tr><td>Ubuntu 20.04</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td><td style="text-align:center;">x</td></tr><tr><td>Ubuntu 22.04</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td><td style="text-align:center;">x</td></tr><tr><td>Debian 11</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td><td style="text-align:center;">x</td></tr><tr><td>Rocky Linux 8</td><td style="text-align:center;">✓</td><td style="text-align:center;">✓</td><td style="text-align:center;">x</td></tr></tbody></table></li><li><p><span class="notranslate"><em>Automatically scan any file uploaded using web</em></span> – enables real-time scanning of all the files that were uploaded via http/https.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>It requires <a href="https://modsecurity.org/" target="_blank" rel="noopener noreferrer">ModSecurity</a> to be installed.</p></div></li><li><p><span class="notranslate"><em>Automatically scan any file uploaded using ftp</em></span> – enables real-time scanning of all the files that were uploaded via ftp.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>It requires <a href="https://www.pureftpd.org/project/pure-ftpd" target="_blank" rel="noopener noreferrer">Pure-FTPd</a> to be used as FTP service.</p></div></li><li><p><span class="notranslate"><em>Automatically send suspicious and malicious files for analysis</em></span> – malicious and suspicious files will be sent to the Imunify360 Team for analysis automatically.</p></li>',5),ks=e("span",{class:"notranslate"},[e("em",null,"Try to restore from backup first")],-1),Is={class:"notranslate"},Ps=o('<li><p><span class="notranslate"><em>Block malicious file uploads via cPanel File Manager</em></span><sup><em>Experimental</em></sup> – enable blocking malicious file uploads via cPanel File Manager. Also, the file operations via cPanel File Manager that turn out to be malicious are blocked. The type of operations processed are: edits and saves.</p></li><li><p><span class="notranslate"><em>Use backups not older than (days)</em></span> – allows to set the a maximum age of a clean file.</p></li><li><p><span class="notranslate"><em>Default action on detect</em></span> – configure Malware Scanner actions when detecting malicious activity:</p><ul><li><span class="notranslate">Just display in dashboard</span></li><li><span class="notranslate">Cleanup</span> (default)</li></ul><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>Starting from ImunifyAV(+) v.6.2, the <em>Quarantine</em> and <em>Delete</em> actions were removed permanently from the UI as well as the CLI in ImunifyAV(+). Previously quarantined files are also subject to deletion. After this change is implemented, the restoration of the previously quarantined files will become impossible. For more information see this <a href="https://blog.imunify360.com/file-quarantine-is-no-longer-effective" target="_blank" rel="noopener noreferrer">this blog post</a>.</p></div></li>',3),xs=e("div",{class:"tip custom-block"},[e("p",{class:"custom-block-title"},"Note"),e("p",null,"Those options may be hidden for end-user if Cleanup is disabled in Features Management.")],-1),Ss=e("span",{class:"notranslate"},[e("em",null,"Enable RapidScan")],-1),Cs=e("li",null,[e("span",{class:"notranslate"},[e("em",null,"Binary (ELF) malware detection")]),a(" – this option allows to search for any binaries (ELF files) in the user home directories and consider them malicious.")],-1),Ts=e("li",null,[e("span",{class:"notranslate"},[e("em",null,"Enable Hyperscan")]),a(" – this option allows to use the regex matching Hyperscan library in Malware Scanner to greatly improve the scanning speed. Hyperscan requires its own signatures set that will be downloaded from the files.imunify360.com and compiled locally. There are few platform requirements to use this feature: "),e("ul",null,[e("li",null,"Hyperscan supports Debian, Ubuntu and CentOS/CloudLinux 7 and later."),e("li",null,"SSE3 processor instructions support. It is quite common nowadays, but may be lacking in virtual environments or in some rather old servers.")])],-1),Ds=o('<h4 id="crontab-files-scanning" tabindex="-1"><a class="header-anchor" href="#crontab-files-scanning" aria-hidden="true">#</a> Crontab files Scanning</h4><p>This is the mechanism allowing to address Crontab infections with our powerful Malware scanner. Enabled, it will catch any event of Crontab file modification on the fly in seconds and keep them malware-free in real-time.</p><img src="'+h+'" border="1px solid grey"><p>The cleanup results are available on the <em>Malware</em> and <em>History</em> tabs of the Imunify360 interface as for any other type of malware.</p><p>Tick required checkboxes and click <span class="notranslate"><em>Save changes</em></span> button.</p><h4 id="background-scanning" tabindex="-1"><a class="header-anchor" href="#background-scanning" aria-hidden="true">#</a> Background Scanning</h4><p>Allows to set up automatic, scheduled, background scanning of user accounts.</p><ul><li><span class="notranslate"><em>Run scanning</em></span> — select the desired period: <ul><li><span class="notranslate">Never</span></li><li><span class="notranslate">Daily</span></li><li><span class="notranslate">Weekly</span></li><li><span class="notranslate">Monthly</span></li></ul></li></ul><p><img src="'+ta+'" alt=""></p><p>Depending on the selected period, precise settings.</p><ul><li><p>If <span class="notranslate"><em>Run scanning</em></span> is set to <span class="notranslate"><em>Daily</em></span>, choose the exact time at the <span class="notranslate"><em>Run at</em></span> dropdown.</p></li><li><p>If <span class="notranslate"><em>Run scanning</em></span> is set to <span class="notranslate"><em>Weekly</em></span>, choose the day of the week at the <span class="notranslate"><em>Run on</em></span> dropdown and exact time at the <span class="notranslate"><em>Run at</em></span> dropdown.</p></li><li><p>If <span class="notranslate"><em>Run scanning</em></span> is set to <span class="notranslate"><em>Monthly</em></span>, choose the day of the month at the <span class="notranslate"><em>Day of month to run</em></span> dropdown and exact time at the <span class="notranslate"><em>Run at</em></span> dropdown.</p></li></ul><p>You can track the scanning activity at the <span class="notranslate"><a href="#malware-scanner">Malware Scanner</a></span> tab.</p><h4 id="cleanup" tabindex="-1"><a class="header-anchor" href="#cleanup" aria-hidden="true">#</a> Cleanup</h4><ul><li><span class="notranslate"><em>Trim file instead of removal</em></span> — do not remove infected file during cleanup but make the file zero-size (for malware like web-shells);</li><li><span class="notranslate"><em>Keep original files for … days</em></span> — the original infected file is available for restoration within the defined period. The default is 14 days.</li></ul><p><img src="'+sa+'" alt=""></p><h4 id="proactive-defense-1" tabindex="-1"><a class="header-anchor" href="#proactive-defense-1" aria-hidden="true">#</a> Proactive Defense</h4><ul><li><span class="notranslate"><em>Enable Blamer</em></span> — tick to allow Imunify360 to find a root cause of how infection got injected into the server through PHP. Blamer pinpoints the exact URL, PHP script &amp; PHP execution path that allowed a hacker to inject malware onto the server. Imunify360 security team will use that information to prevent future infections from happening.</li></ul><p><img src="'+na+'" alt=""></p><p>To reduce the number of blamer events, similar events are combined by default into a single one. In order to disable it, specify the <span class="notranslate"><code>filter_messages=off</code></span> in the <span class="notranslate"><em>/usr/share/i360-php-opts/module.ini</em></span></p><ul><li><span class="notranslate"><em>PHP Immunity</em></span> — tick to allow Imunify360 automatically detect and patch vulnerabilities in software at the Proactive Defense level preventing re-infections through the same vulnerability.</li></ul><p>Once a vulnerable script or unknown malware executes any malicious flow which in turn leads to a malware drop, it causes the auto-generate rule to be released for the Proactive Defence. Ultimately, it will stop any further attempts to exploit the vulnerability or drop malware. Any dropped malware will be also auto-cleaned by the real-time malware scanner keeping the system clean and protected.</p><p><img src="'+oa+'" alt=""></p><p>By enabling this feature Blamer will be enabled as well and Proactive Defence switched into the KILL mode.</p><p>Click <span class="notranslate"><em>Save changes</em></span> at the page bottom to apply all changes.</p><h4 id="malware-database-scanner" tabindex="-1"><a class="header-anchor" href="#malware-database-scanner" aria-hidden="true">#</a> Malware Database Scanner</h4><p><img src="'+ia+'" alt=""></p><p>Enable <span class="notranslate"><em>Malware Database Scanner</em></span> – a database antivirus: automated malware detection and clean-up of web applications.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Requires MariaDB/MySQL DB management system version 5.5. The recommended version is 5.6+. Note, only WordPress databases are supported as of now.</p></div><p>Click <span class="notranslate"><em>Save changes</em></span> to apply changes.</p><h3 id="backups" tabindex="-1"><a class="header-anchor" href="#backups" aria-hidden="true">#</a> Backups</h3><h4 id="overview-1" tabindex="-1"><a class="header-anchor" href="#overview-1" aria-hidden="true">#</a> Overview</h4><p>Imunify360 provides customers with the ability to integrate with backup providers and automatically or manually restore files from their backup if they have become infected. Only the administrator can choose a backup provider but the end-user has the ability to backup and restore files within this selected backup provider.</p><p>The following integrated with Imunify360 backup providers are available:</p><ul><li>Hosting panel Backup (cPanel, Plesk, or DirectAdmin)</li><li><span class="notranslate">Acronis Backup</span></li></ul><div class="warning custom-block"><p class="custom-block-title">Warning</p><p><strong>JetBackup</strong>: The Imunify360 integration is implemented on the JetBackup side. JetBackup server backup application is not available right now because of the rework.</p></div>',35),As=e("p",null,[e("strong",null,"Requirements")],-1),Ms=e("ul",null,[e("li",null,"Imunify360 version 2.7.0 and later"),e("li",null,[a("For "),e("span",{class:"notranslate"},"Acronis Backup"),a(", it is required to have Acronis account")]),e("li",null,"For the hosting panel backup, it is required that the backup option is configured by the administrator of the hosting panel")],-1),Ls=e("h4",{id:"how-to-enable-backups",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#how-to-enable-backups","aria-hidden":"true"},"#"),a(" How to enable backups")],-1),qs=e("p",null,"To enable backups log in to a hosting panel as administrator, go to the Imunify360 plugin and do the following.",-1),Ns=e("li",null,[a("Go to "),e("span",{class:"notranslate"},[e("em",null,"Imunify360 → Settings → Backups")]),a(". If the feature is not currently used the "),e("span",{class:"notranslate"},[e("em",null,"Backup and restore")]),a(" is "),e("span",{class:"notranslate"},[e("em",null,"Disabled")]),a(".")],-1),Hs={class:"notranslate"},Bs={class:"notranslate"},Fs=o('<p><img src="'+la+'" alt=""></p><h4 id="acronis-backup" tabindex="-1"><a class="header-anchor" href="#acronis-backup" aria-hidden="true">#</a> Acronis Backup</h4><p>Choose it if you have an Acronis account. So that Imunify360 can use backups to restore malicious or suspicious files from the backup if a clean version exists.</p><ul><li>Select <span class="notranslate"><em>Acronis Backup</em></span> from the dropdown</li><li>Specify <span class="notranslate"><em>Acronis username</em></span> and <span class="notranslate"><em>password</em></span></li><li>Click <span class="notranslate"><em>Connect Backup</em></span> button</li></ul><p>Imunify360 checks if the Acronis agent is already installed. If not, Imunify360 installs it. Then Imunify360 checks, if a backup of the entire server exists, if not, Imunify360 creates a backup of a current server. If all is OK the system returns a successful message.</p><p><img src="'+ra+'" alt=""></p><h4 id="cpanel-plesk-or-directadmin-backup" tabindex="-1"><a class="header-anchor" href="#cpanel-plesk-or-directadmin-backup" aria-hidden="true">#</a> cPanel Plesk or DirectAdmin Backup</h4><ul><li>Choose cPanel/Plesk/DirectAdmin backup</li><li>Select <span class="notranslate"><em>cPanel/Plesk/DirectAdmin Backup</em></span></li><li>Click <span class="notranslate"><em>Connect Backup</em></span> button</li></ul><p><img src="'+ca+'" alt=""></p><p>After the successful connection, Imunify360 will return the appropriate message.</p><h4 id="how-to-disable-backups" tabindex="-1"><a class="header-anchor" href="#how-to-disable-backups" aria-hidden="true">#</a> How to disable backups</h4><p>To disable backups do the following:</p><ul><li>Go to <span class="notranslate"><em>Imunify360 → Settings → Backups</em></span></li><li>Move the slider to <span class="notranslate"><em>Disabled</em></span></li><li>Imunify360 returns confirmation pop-up</li><li>Click <span class="notranslate"><em>Yes, disable backup</em></span> to disable backups or click <span class="notranslate"><em>Cancel</em></span> to close the pop-up.</li></ul><h4 id="how-to-restore-file" tabindex="-1"><a class="header-anchor" href="#how-to-restore-file" aria-hidden="true">#</a> How to restore file</h4><p>To restore a file do the following:</p><ul><li>Go to <span class="notranslate"><em>Imunify360 → Malware Scanner</em></span>.</li><li>Find the file to restore in the table and click <em>Cog</em> icon, then click <span class="notranslate"><em>Try to restore clean version from backup</em></span>.</li><li>In the pop-up confirm the action by clicking <span class="notranslate"><em>Yes, restore from backup</em></span> or click <span class="notranslate"><em>Cancel</em></span> to close the pop-up.</li></ul>',16),Rs=e("h3",{id:"disabled-rules",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#disabled-rules","aria-hidden":"true"},"#"),a(" Disabled Rules")],-1),Es=e("p",null,[a("Go to "),e("span",{class:"notranslate"},[e("em",null,"Settings")]),a(" page and choose "),e("span",{class:"notranslate"},[e("em",null,"Disabled rules")]),a(". This page allows users to manage disabled rules which have already been added.")],-1),Ws={class:"tip custom-block"},Os=e("p",{class:"custom-block-title"},"Note",-1),Gs=e("span",{class:"notranslate"},"Disabled Rules",-1),Us=o('<p>The list of disabled rules contains:</p><ul><li><span class="notranslate"><em>Rule ID</em></span> — ID number of the rule provided by the plugin</li><li><span class="notranslate"><em>Plugin</em></span> — the name of the firewall plugin of the added rule</li><li><span class="notranslate"><em>Description</em></span> — rule description or details of the rule from ModSecurity or OSSEC</li><li><span class="notranslate"><em>Domains</em></span> — the list of the domains for which the rule is disabled (blank field means all domains)</li></ul><p>To add a new rule click <span class="notranslate"><em>Add Rule</em></span> button.</p><p><img src="'+pa+'" alt=""></p><p>In the pop-up specify the following:</p><ul><li><span class="notranslate"><em>Rule ID</em></span> — ID provided by firewall plugin;</li><li>Select firewall plugin from the drop-down (ossec for OSSEC, modsec for ModSecurity)</li><li><span class="notranslate"><em>Description</em></span> — rule description or details from ModSecurity or OSSEC</li><li><span class="notranslate"><em>Domains</em></span> — this option is available only for modsec firewall plugin. Specify a comma-separated list of domains for which this rule will be disabled. Leave empty to disable for all domains</li></ul><p>Click <span class="notranslate"><em>Add Rule</em></span> to add rule to the list or <span class="notranslate"><em>Cancel</em></span> to close the pop-up.</p><p><img src="'+da+'" alt=""></p><p>To edit the list of domains where the rule should be disabled, click the edit icon in the row of the rule and enter domains registered on the server separated by a comma.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>It is possible to specify domains only for ModSecurity rules. For OSSEC rules it always applies to all domains.</p></div><p><img src="'+ha+'" alt=""></p><p>To remove the rule from the disabled list click <span class="notranslate"><em>Enable</em></span> and confirm the action in the pop-up.</p><p><img src="'+ma+'" alt=""></p><h3 id="features-management" tabindex="-1"><a class="header-anchor" href="#features-management" aria-hidden="true">#</a> Features Management</h3><p><strong>Overview</strong></p><p><span class="notranslate">Features Management</span> allows hosters to enable/disable Imunify360 features for each customer. On <span class="notranslate">Features Management</span> it is possible to manage <span class="notranslate">Proactive Defense</span> and <span class="notranslate">Malware Cleanup</span> for each customer account. If a feature is enabled for the user in the hoster’s account, the user will be able to see and use it in his account.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Default settings in <span class="notranslate">Features Management</span> are inherited by newly created user accounts only.</p></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Features are enabled/disabled account-wide.</p></div><p><img src="'+ua+'" alt=""></p><p>Below, there is a table with all users and their domains and features for each user.</p><p><img src="'+ga+'" alt=""></p><ul><li><span class="notranslate"><strong>Name</strong></span> — username or path to a user;</li><li><span class="notranslate"><strong>Domains</strong></span> — a list of user’s domains;</li><li><span class="notranslate"><strong>Proactive Defense</strong></span> — a slider to enable/disable the feature for a specific user. Move a slider in feature column to enable/disable that feature for a specific user. After that, this specific feature tab will be displayed/hid in that user’s account.</li><li><span class="notranslate"><strong>Malware Cleanup</strong></span> — a slider to enable/disable the feature for a specific user. Move a slider in feature column to enable/disable that feature for a specific user. After that, the <span class="notranslate">Cleanup</span> button will be available in the Malicious files list in that user’s account.</li></ul><p><strong>Group Action</strong> To perform a group action tick the users and move sliders for them.</p><p><img src="'+fa+'" alt=""></p><p><strong>How to enable/disable <span class="notranslate">Proactive Defense</span></strong></p><p>The <span class="notranslate">Proactive Defense</span> feature is enabled by default account-wide. So, all newly created user accounts will have <span class="notranslate">Proactive Defence</span> tab in their Imunify360 Section.</p><p><img src="'+ba+'" alt=""></p><p>To disable <span class="notranslate">Proactive Defense</span> account-wide just move the slider to <span class="notranslate"><em>Turned Off</em></span>. And confirm the action in the popup by clicking <span class="notranslate"><em>Yes, disable Proactive Defense for new users</em></span> or click <span class="notranslate"><em>Cancel</em></span> to close the popup.</p><p><img src="'+va+'" alt=""></p><p><strong>How to enable/disable <span class="notranslate">Malware Cleanup</span></strong></p><p>The <span class="notranslate">Malware Cleanup</span> feature is enabled by default account-wide. So, all newly created user accounts will have <span class="notranslate">Malware Cleanup</span> feature in their Imunify360.</p><p><img src="'+wa+'" alt=""></p><p>To disable <span class="notranslate">Malware Cleanup</span> account-wide just move the slider to <span class="notranslate"><em>Turned Off</em></span>. And confirm the action in the popup by clicking <span class="notranslate"><em>Yes, disable Malware Cleanup for new users</em></span> or click <span class="notranslate"><em>Cancel</em></span> to close the popup.</p><p><img src="'+ya+'" alt=""></p>',34),Ys=o('<div class="notranslate"><h3 id="native-feature-management" tabindex="-1"><a class="header-anchor" href="#native-feature-management" aria-hidden="true">#</a> Native Feature Management</h3></div><p><span class="notranslate">Feature Management</span> allows a hoster to enable/disable different Imunify360 features for server users. Using this functionality, hosting companies may resell chosen Imunify360 features as a part of hosting packages to end-users as well as make features available/unavailable for a group of end-users.</p><h3 id="whm-cpanel" tabindex="-1"><a class="header-anchor" href="#whm-cpanel" aria-hidden="true">#</a> WHM/cPanel</h3><p><span class="notranslate">WHM/cPanel Feature Management</span> is now available under <span class="notranslate">WHM/cPanel Package Manager</span> via <span class="notranslate">Package Extension (PE)</span>. Using <span class="notranslate">WHM/cPanel Native Feature Management</span> a hoster can enable/disable <span class="notranslate">Malware Scanner</span> and <span class="notranslate">Proactive Defense</span> for all users with the same package (service plan) instantly.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>When switched to <span class="notranslate">WHM/cPanel Feature Management</span>, the same functionality will be disabled in the Imunify360 UI. The previous Feature Management config becomes overridden by defaults.</p></div><p><strong>How to switch to WHM/cPanel Feature Management</strong></p><p>Go to <span class="notranslate">Imunify360 → Settings → Features Management</span>. You will see the following.</p><p><img src="'+_a+'" alt=""></p><p>Click <span class="notranslate"><em>Details</em></span>. You will see the following pop-up.</p><p><img src="'+ka+'" alt=""></p><p>Click <span class="notranslate"><em>Agree and Switch</em></span> to confirm the action or click <span class="notranslate"><em>Cancel</em></span> to close the popup.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Note that current Imunify360 settings will be reset to default values after switching to <span class="notranslate">WHM/cPanel Feature Management</span> mode. You can switch back to in-app <span class="notranslate">Imunify360 Feature Management</span> mode at any time via CLI command. The end-user values will be reset to default values upon any mode switching.</p></div><p>When switched, you will see the following.</p><p><img src="'+Ia+'" alt=""></p><p><strong>How to configure Imunify360 Features using WHM/cPanel Package Extensions</strong></p><p>Go to <span class="notranslate">WHM/cPanel → Add a Package → Package Extensions</span> and tick <span class="notranslate">Imunify360 Features</span> (if it’s not selected).</p><p><img src="'+Pa+'" alt=""></p><p>Choose an option for each feature.</p><p><span class="notranslate"><strong>Malware Scanner</strong></span></p><ul><li><span class="notranslate"><em>View reports + Cleanup</em></span> – a user can view scanning reports and cleanup found malware</li><li><span class="notranslate"><em>View reports only</em></span> – a user can view scanning reports but can&#39;t cleanup found malware</li><li><span class="notranslate"><em>Not available</em></span> – the <span class="notranslate">Malware Scanner</span> is not available for a user, and its tab is hidden on the Imunify360 main menu</li></ul><div class="tip custom-block"><p class="custom-block-title">Note</p><p>The last option is available in the WHM/cPanel Package Manager only and is not available via Imunify360 UI or CLI.</p></div><div class="warning custom-block"><p class="custom-block-title">Note</p><p>When the <strong>Malware Scanner is not available</strong> for the end-user, it doesn&#39;t exclude user folders from scanning, so his files will be scanned and the results will be listed in an admin UI as usual.</p></div><p><span class="notranslate"><strong>Proactive Defense</strong></span></p><ul><li><span class="notranslate"><em>Available</em></span> – the <span class="notranslate">Proactive Defense</span> feature is available for a user</li><li><span class="notranslate"><em>Not available</em></span> – the <span class="notranslate">Proactive Defense</span> is deactivated for a user: the feature does not run and its UI is hidden from the Imunify360 main menu</li></ul><p>Click <span class="notranslate"><em>Add</em></span> to apply changes.</p>',25),zs=e("h3",{id:"attributions",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#attributions","aria-hidden":"true"},"#"),a(" Attributions")],-1),js=e("span",{class:"notranslate"},[e("em",null,"Settings")],-1),Ks=e("span",{class:"notranslate"},[e("em",null,"Attributions")],-1),Vs=o('<ul><li><span class="notranslate"><em>Name</em></span> – name of the IDS</li><li><span class="notranslate"><em>Version</em></span> – IDS version</li><li><span class="notranslate"><em>License</em></span> – under which licenses this IDS is working</li><li><span class="notranslate"><em>Link</em></span> – URL to the IDS official page</li></ul><p><img src="'+xa+'" alt=""></p><p>Country-based white or blacklisting includes GeoLite2 data created by MaxMind, available from <a href="https://www.maxmind.com" target="_blank" rel="noopener noreferrer">https://www.maxmind.com</a>.</p><h4 id="hosting-panels-specific-settings" tabindex="-1"><a class="header-anchor" href="#hosting-panels-specific-settings" aria-hidden="true">#</a> Hosting panels specific settings</h4><p><strong>cPanel</strong></p><p>It is possible to enable the Service Status checker for Imunify360. Perform the following steps:</p><ul><li>Go to <span class="notranslate"><em>Service Configuration</em></span> and choose <span class="notranslate"><em>Service Manager</em></span>.</li><li>In <span class="notranslate"><em>Additional Services</em></span> section tick <span class="notranslate"><code>imunify360</code></span> checkbox.</li><li>Click <span class="notranslate"><em>Save</em></span> and wait until cPanel enables the Service Status checker for Imunify360.</li></ul><p><img src="'+Sa+'" alt=""></p><p>If succeeded, the status of the Imunify360 service will be displayed at the Service Status section of Server Status.</p><p><img src="'+Ca+'" alt=""></p>',10);function Js(Qs,$s){const s=l("RouterLink"),d=l("Badge");return u(),g("div",null,[Da,e("p",null,[a("Or you can do it later in the "),e("span",Aa,[t(s,{to:"/dashboard/#contact-details"},{default:n(()=>[a("Settings | General | Contact Details")]),_:1})]),a(".")]),Ma,La,e("ul",null,[e("li",null,[e("p",null,[e("span",qa,[t(s,{to:"/dashboard/#support"},{default:n(()=>[a("Support")]),_:1})]),a(" – allows you to contact our support team directly from your Imunify360 Admin Interface")])]),e("li",null,[e("p",null,[e("span",Na,[t(s,{to:"/dashboard/#dashboard"},{default:n(()=>[a("Dashboard")]),_:1})]),a(" – allows you to see retrospective data in form of charts/heatmaps in your Imunify360 Admin Interface")])]),e("li",null,[e("p",null,[e("span",Ha,[t(s,{to:"/dashboard/#incidents"},{default:n(()=>[a("Incidents")]),_:1})]),a(" – the list of all suspicious activity on the server.")])]),e("li",null,[e("p",null,[e("span",Ba,[t(s,{to:"/dashboard/#firewall"},{default:n(()=>[a("Firewall")]),_:1})]),a(" – a dashboard of "),Fa,a(" and "),Ra,a(", and "),Ea,a(" with the ability to manage them.")])]),e("li",null,[e("p",null,[e("span",Wa,[t(s,{to:"/dashboard/#malware-scanner"},{default:n(()=>[a("Malware Scanner")]),_:1})]),a(" – real-time file scanner.")])]),e("li",null,[e("p",null,[e("span",Oa,[t(s,{to:"/dashboard/#proactive-defense"},{default:n(()=>[a("Proactive Defense")]),_:1})]),a(" – a unique Imunify360 feature that can prevent malicious activity through PHP scripts")])]),e("li",null,[e("p",null,[e("span",Ga,[t(s,{to:"/dashboard/#reputation-management"},{default:n(()=>[a("Reputation Management")]),_:1})]),a(" – analyzing and notifying tool intended to inform about websites blocking and blacklisting.")])]),e("li",null,[e("p",null,[e("span",Ua,[t(s,{to:"/dashboard/#kernelcare-integration"},{default:n(()=>[a("KernelCare")]),_:1})]),a(" – KernelCare current state.")])]),e("li",null,[e("p",null,[e("span",Ya,[t(s,{to:"/dashboard/#settings"},{default:n(()=>[a("Imunify360 Settings")]),_:1})]),a(" – configuring and controlling Imunify360 options.")])])]),za,e("div",ja,[Ka,e("p",null,[a("If you do not want to use the recommendations you can disable Imunify Advisor via the "),t(s,{to:"/config_file_description/"},{default:n(()=>[a("config file")]),_:1}),a(".")])]),Va,e("ul",null,[e("li",null,[a("Go to the server "),Ja,a(),Qa,a(" and copy its server key (see "),t(s,{to:"/dashboard/#how-to-get-a-server-key"},{default:n(()=>[a("How to get a server key")]),_:1}),a(")")]),$a,Xa]),Za,e("p",null,[a("Choose "),et,a(" tab to view and manage the list of all the "),t(s,{to:"/terminology/"},{default:n(()=>[a("incidents")]),_:1}),a(". The table displays a list of detected incidents with all the information about the incidents reasons.")]),at,e("p",null,[a("See also: "),t(s,{to:"/features/#external-black-whitelist-management"},{default:n(()=>[a("How to use external files with the list of Black/White IPs")]),_:1})]),tt,e("p",null,[a("Or you can set the default blocking mode via "),t(s,{to:"/config_file_description/"},{default:n(()=>[a("CLI and config file")]),_:1}),a(".")]),st,e("div",nt,[ot,e("p",null,[a("The functionality described here depends on "),e("span",it,[t(s,{to:"/dashboard/#malware"},{default:n(()=>[a("Malware Scanner settings")]),_:1})]),a(".")])]),lt,e("ul",null,[e("li",null,[e("span",rt,[t(s,{to:"/dashboard/#users"},{default:n(()=>[a("Users")]),_:1})])]),e("li",null,[e("span",ct,[t(s,{to:"/dashboard/#files"},{default:n(()=>[a("Files")]),_:1})])]),e("li",null,[e("span",pt,[t(s,{to:"/dashboard/#scan"},{default:n(()=>[a("Scan")]),_:1})])]),e("li",null,[e("span",dt,[t(s,{to:"/dashboard/#history"},{default:n(()=>[a("History")]),_:1})])]),e("li",null,[e("span",ht,[t(s,{to:"/dashboard/#ignore-list"},{default:n(()=>[a("Ignore List")]),_:1})])])]),mt,e("p",null,[a("See also: "),t(s,{to:"/faq_and_known_issues/#_22-how-to-edit-watched-and-excluded-patterns-for-malware-scanner"},{default:n(()=>[a("How to edit watched and excluded patterns for Malware Scanner?")]),_:1})]),ut,e("div",gt,[ft,e("p",null,[a("Proactive Defense requires "),t(s,{to:"/dashboard/#installation"},{default:n(()=>[a("Hardened PHP")]),_:1}),a(" (alt-php) to operate.")])]),bt,e("p",null,[a("See also: "),t(s,{to:"/faq_and_known_issues/#_22-how-to-edit-watched-and-excluded-patterns-for-malware-scanner"},{default:n(()=>[a("How to edit watched and excluded patterns for Malware Scanner?")]),_:1}),a(".")]),vt,e("p",null,[a("Imunify360 has "),wt,a(" KernelCare integration. To install KernelCare go to the "),t(s,{to:"/dashboard/#settings"},{default:n(()=>[a("Settings")]),_:1}),a(" tab and click "),yt,a(".")]),_t,e("ul",null,[e("li",null,[e("span",kt,[t(s,{to:"/dashboard/#general"},{default:n(()=>[a("General")]),_:1})])]),e("li",null,[e("span",It,[t(s,{to:"/dashboard/#malware"},{default:n(()=>[a("Malware")]),_:1})])]),e("li",null,[e("span",Pt,[t(s,{to:"/dashboard/#backups"},{default:n(()=>[a("Backups")]),_:1})])]),e("li",null,[e("span",xt,[t(s,{to:"/dashboard/#disabled-rules"},{default:n(()=>[a("Disables Rules")]),_:1})])]),e("li",null,[e("span",St,[t(s,{to:"/dashboard/#attributions"},{default:n(()=>[a("Attributions")]),_:1})])]),e("li",null,[e("span",Ct,[t(s,{to:"/features/#notifications"},{default:n(()=>[a("Notifications")]),_:1})])])]),Tt,Dt,e("ul",null,[e("li",null,[e("span",At,[t(s,{to:"/dashboard/#installation"},{default:n(()=>[a("Installation")]),_:1})])]),e("li",null,[e("span",Mt,[t(s,{to:"/dashboard/#waf-settings"},{default:n(()=>[a("WAF Settings")]),_:1})])]),e("li",null,[e("span",Lt,[t(s,{to:"/dashboard/#dos-protection"},{default:n(()=>[a("DoS Protection")]),_:1})])]),e("li",null,[e("span",qt,[t(s,{to:"/dashboard/#smtp-traffic-manager"},{default:n(()=>[a("SMTP Traffic Manager")]),_:1})])]),e("li",null,[e("span",Nt,[t(s,{to:"/dashboard/#_3-rd-party-integration"},{default:n(()=>[a("3-rd Party Integration")]),_:1})])]),e("li",null,[e("span",Ht,[t(s,{to:"/dashboard/#auto-white-list"},{default:n(()=>[a("Auto White List")]),_:1})])]),e("li",null,[e("span",Bt,[t(s,{to:"/dashboard/#incidents-logging"},{default:n(()=>[a("Incidents Logging")]),_:1})])]),e("li",null,[e("span",Ft,[t(s,{to:"/dashboard/#webshield"},{default:n(()=>[a("WebShield")]),_:1})])]),e("li",null,[e("span",Rt,[t(s,{to:"/dashboard/#anti-bot-protection"},{default:n(()=>[a("Anti-bot protection")]),_:1})])]),e("li",null,[e("span",Et,[t(s,{to:"/dashboard/#ossec"},{default:n(()=>[a("OSSEC")]),_:1})])]),e("li",null,[e("span",Wt,[t(s,{to:"/dashboard/#pam"},{default:n(()=>[a("PAM")]),_:1})])]),e("li",null,[e("span",Ot,[t(s,{to:"/dashboard/#error-reporting"},{default:n(()=>[a("Error Reporting")]),_:1})])]),e("li",null,[e("span",Gt,[t(s,{to:"/dashboard/#contact-details"},{default:n(()=>[a("Contact Details")]),_:1})])])]),Ut,Yt,zt,e("p",null,[a("If you want to install it using CLI, please follow "),t(s,{to:"/command_line_interface/#features"},{default:n(()=>[a("this article")]),_:1}),a(". "),jt]),Kt,e("h4",Vt,[Jt,a(" Privilege escalation detection & protection "),t(d,{text:"Deprecated",type:"error",vertical:"top"})]),Qt,$t,e("p",null,[a("You can find these attempts on the "),t(s,{to:"/dashboard/#incidents"},{default:n(()=>[a("Incidents tab")]),_:1}),a(" (as part of the OSSEC log). The incidents can be seen by filtering events with the "),Xt,a(" label.")]),Zt,e("p",null,[a("This feature can be enabled by setting "),es,a(" in MOD_SEC "),t(s,{to:"/config_file_description/#config-file-description"},{default:n(()=>[a("config file section")]),_:1})]),e("div",as,[ts,e("p",null,[a("This feature is implemented via modsec rule and could be partially "),t(s,{to:"/command_line_interface/#rules"},{default:n(()=>[a("disabled on a per-domain basis")]),_:1}),a(" (the rule id is 33355)")])]),ss,e("ul",null,[ns,e("li",null,[os,a(" – allows to setup period in seconds between each DoS detection system activation that will check a server for DoS attack. Also, it is possible to set different limits for different local ports by editing the "),t(s,{to:"/config_file_description/"},{default:n(()=>[a("configuration file")]),_:1}),a(" directly.")])]),is,e("p",null,[a("The Enhanced DOS Protection feature forms an additional layer of protection, increasing the stability of servers facing DOS attacks. It takes a different approach than our existing "),t(s,{to:"/dashboard/#dos-protection"},{default:n(()=>[a("DOS Protection feature")]),_:1}),a(", which focuses on monitoring the number of simultaneous connections. Enhanced DOS Protection, on the other hand, monitors the rate of requests originating from attacker IP addresses per unit of time.")]),ls,e("p",null,[a("This settings is explained in more detail "),t(s,{to:"/ids_integration/#_3-rd-party-integration-mode"},{default:n(()=>[a("here")]),_:1})]),rs,e("p",null,[a("In this section it is possible to control what kind of incidents will be shown on the "),t(s,{to:"/dashboard/#incidents"},{default:n(()=>[a("Incidents page")]),_:1}),a(". Move the slider to change your preferences.")]),cs,e("p",null,[a("You can read more about Anti-bot protection "),t(s,{to:"/features/#anti-bot-protection"},{default:n(()=>[a("here")]),_:1}),a(".")]),ps,e("p",null,[a("More about the feature "),t(s,{to:"/features/#cpanel-account-protection"},{default:n(()=>[a("here")]),_:1}),a(".")]),ds,e("ul",null,[e("li",null,[t(s,{to:"/dashboard/#resource-consumption"},{default:n(()=>[hs]),_:1})]),e("li",null,[t(s,{to:"/dashboard/#general-1"},{default:n(()=>[ms]),_:1})]),e("li",null,[t(s,{to:"/dashboard/#background-scanning"},{default:n(()=>[us]),_:1})]),e("li",null,[t(s,{to:"/dashboard/#cleanup"},{default:n(()=>[gs]),_:1})]),e("li",null,[t(s,{to:"/dashboard/#proactive-defense-2"},{default:n(()=>[fs]),_:1})]),e("li",null,[t(s,{to:"/dashboard/#malware-database-scanner"},{default:n(()=>[bs]),_:1})])]),e("div",vs,[ws,e("p",null,[a("Read "),t(s,{to:"/ids_integration/#cxs-integration"},{default:n(()=>[a("CXS integration")]),_:1}),a(" documentation carefully to make Malware Scanner work properly if you decided to use the former instead of Imunify360 anti-malware protection.")])]),ys,e("ul",null,[_s,e("li",null,[e("p",null,[ks,a(" – allows to restore file as soon as it was detected as malicious from backup if a clean copy exists. If a clean copy does not exist or it is outdated, default action will be applied. See also "),e("span",Is,[t(s,{to:"/dashboard/#backups"},{default:n(()=>[a("CloudLinux Backup")]),_:1})]),a(".")])]),Ps]),xs,e("ul",null,[e("li",null,[Ss,a(" – dramatically speeds up repeated scans based on smart re-scan approach, local result caching and cloud-assisted scan. When you first enable the RapidScan feature, the first scan will run as before. But subsequent scans will see a dramatic speed improvement, anywhere between 5 to 20 times faster. You can find details "),t(s,{to:"/features/#rapidscan"},{default:n(()=>[a("here")]),_:1}),a(".")]),Cs,Ts]),Ds,f(" Imunify360 is integrated with the JetBackup server backup application. Anyone using JetBackup with WHM or cPanel can elect to use Imunify360. You can find more details [here](https://blog.imunify360.com/imunify360-now-integrated-with-jetbackup). "),As,Ms,Ls,qs,e("ul",null,[Ns,e("li",null,[a("To enable it, select the backup provider from the dropdown: "),e("ul",null,[e("li",null,[e("span",Hs,[t(s,{to:"/dashboard/#acronis-backup"},{default:n(()=>[a("Acronis Backup")]),_:1})])]),e("li",null,[e("span",Bs,[t(s,{to:"/dashboard/#cpanel-plesk-or-directadmin-backup"},{default:n(()=>[a("cPanel Plesk or DirectAdmin Backup")]),_:1})])])])])]),Fs,e("p",null,[a("You can configure the automatic restore. Please find more details "),t(s,{to:"/dashboard/#malware"},{default:n(()=>[a("here")]),_:1}),a(".")]),Rs,Es,e("div",Ws,[Os,e("p",null,[a("You can also add a new rule to the "),Gs,a(" list on the "),t(s,{to:"/dashboard/#incidents"},{default:n(()=>[a("Incidents")]),_:1}),a(" page.")])]),Us,e("p",null,[a("You can perform all these actions via "),t(s,{to:"/command_line_interface/"},{default:n(()=>[a("CLI")]),_:1}),a(".")]),Ys,e("p",null,[a("See also: "),t(s,{to:"/command_line_interface/"},{default:n(()=>[a("CLI")]),_:1}),a(".")]),zs,e("p",null,[a("Click "),js,a(" and choose "),Ks,a(" tab to observe a list of "),t(s,{to:"/terminology/"},{default:n(()=>[a("IDS")]),_:1}),a(" install on the server.")]),Vs])}const en=m(Ta,[["render",Js],["__file","index.html.vue"]]);export{en as default};
