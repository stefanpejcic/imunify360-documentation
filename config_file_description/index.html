<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.61">
    <script type="text/javascript" charset="UTF-8" src="//cdn.cookie-script.com/s/c9f81de32507a4fec1eb03ee80d0f0ed.js"></script><script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/5408110.js"></script><script>
            (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
            })(window,document,'script','dataLayer','GTM-5MC2SNS');
            </script><script>
              (function() {
                // Trigger the scroll event without actually scrolling
                function triggerScrollEvent() {
                  const targetElement = window;
                  const scrollEvent = new Event('scroll', {
                    bubbles: true,
                    cancelable: true,
                  });
                  targetElement.dispatchEvent(scrollEvent);
                }
        
                // Call the triggerScrollEvent and scrollBodyDown functions after the page is fully loaded
                window.addEventListener('load', () => {
                  triggerScrollEvent();
                });
              })();
            </script><title>Config File Description</title><meta name="description" content="">
    <link rel="preload" href="/assets/style-e2ab0d9e.css" as="style"><link rel="stylesheet" href="/assets/style-e2ab0d9e.css">
    <link rel="modulepreload" href="/assets/app-5759a965.js"><link rel="modulepreload" href="/assets/framework-eb6925b8.js"><link rel="modulepreload" href="/assets/index.html-5f46abbb.js"><link rel="modulepreload" href="/assets/index.html-dec3e580.js"><link rel="prefetch" href="/assets/index.html-e8171bcc.js" as="script"><link rel="prefetch" href="/assets/index.html-f1592cd8.js" as="script"><link rel="prefetch" href="/assets/index.html-12b5593b.js" as="script"><link rel="prefetch" href="/assets/index.html-af3b614e.js" as="script"><link rel="prefetch" href="/assets/index.html-78e35fde.js" as="script"><link rel="prefetch" href="/assets/index.html-5401e2e3.js" as="script"><link rel="prefetch" href="/assets/index.html-72f1f47d.js" as="script"><link rel="prefetch" href="/assets/index.html-9b74e5fe.js" as="script"><link rel="prefetch" href="/assets/index.html-12858481.js" as="script"><link rel="prefetch" href="/assets/index.html-f68e506b.js" as="script"><link rel="prefetch" href="/assets/index.html-21267412.js" as="script"><link rel="prefetch" href="/assets/index.html-4acf38da.js" as="script"><link rel="prefetch" href="/assets/index.html-f28801e4.js" as="script"><link rel="prefetch" href="/assets/index.html-d286dbf1.js" as="script"><link rel="prefetch" href="/assets/index.html-22cab04e.js" as="script"><link rel="prefetch" href="/assets/index.html-b8233d3a.js" as="script"><link rel="prefetch" href="/assets/index.html-31beec6a.js" as="script"><link rel="prefetch" href="/assets/index.html-1ee5676e.js" as="script"><link rel="prefetch" href="/assets/index.html-f83fc907.js" as="script"><link rel="prefetch" href="/assets/index.html-ebfc3abb.js" as="script"><link rel="prefetch" href="/assets/whmcs_saved.html-e44574f5.js" as="script"><link rel="prefetch" href="/assets/index.html-7e64b6d9.js" as="script"><link rel="prefetch" href="/assets/index.html-c201377f.js" as="script"><link rel="prefetch" href="/assets/index.html-3ec87d31.js" as="script"><link rel="prefetch" href="/assets/index.html-87f416f5.js" as="script"><link rel="prefetch" href="/assets/index.html-5c908c82.js" as="script"><link rel="prefetch" href="/assets/index.html-6d1480c5.js" as="script"><link rel="prefetch" href="/assets/index.html-1fc8e0bd.js" as="script"><link rel="prefetch" href="/assets/index.html-23985833.js" as="script"><link rel="prefetch" href="/assets/index.html-16fbd67c.js" as="script"><link rel="prefetch" href="/assets/index.html-7f5598c8.js" as="script"><link rel="prefetch" href="/assets/index.html-233045da.js" as="script"><link rel="prefetch" href="/assets/index.html-fe10d519.js" as="script"><link rel="prefetch" href="/assets/index.html-95490bb8.js" as="script"><link rel="prefetch" href="/assets/404.html-e0575d4e.js" as="script"><link rel="prefetch" href="/assets/index.html-a14be410.js" as="script"><link rel="prefetch" href="/assets/index.html-36c94064.js" as="script"><link rel="prefetch" href="/assets/index.html-b9b07409.js" as="script"><link rel="prefetch" href="/assets/index.html-5fe8923a.js" as="script"><link rel="prefetch" href="/assets/index.html-074752a1.js" as="script"><link rel="prefetch" href="/assets/index.html-f13fbae8.js" as="script"><link rel="prefetch" href="/assets/index.html-64daeacc.js" as="script"><link rel="prefetch" href="/assets/index.html-4c7e50fb.js" as="script"><link rel="prefetch" href="/assets/index.html-89891e2c.js" as="script"><link rel="prefetch" href="/assets/index.html-43c6b3fd.js" as="script"><link rel="prefetch" href="/assets/index.html-6c6ee5cf.js" as="script"><link rel="prefetch" href="/assets/index.html-243331d9.js" as="script"><link rel="prefetch" href="/assets/index.html-e36abcad.js" as="script"><link rel="prefetch" href="/assets/index.html-cdbd2bc6.js" as="script"><link rel="prefetch" href="/assets/index.html-212fa401.js" as="script"><link rel="prefetch" href="/assets/index.html-9b201bee.js" as="script"><link rel="prefetch" href="/assets/index.html-b221eec7.js" as="script"><link rel="prefetch" href="/assets/index.html-0c98a7c4.js" as="script"><link rel="prefetch" href="/assets/index.html-7e94e399.js" as="script"><link rel="prefetch" href="/assets/index.html-bb7c2f7b.js" as="script"><link rel="prefetch" href="/assets/whmcs_saved.html-987473ec.js" as="script"><link rel="prefetch" href="/assets/index.html-bcbde2cc.js" as="script"><link rel="prefetch" href="/assets/index.html-fc2a5594.js" as="script"><link rel="prefetch" href="/assets/index.html-029e4b6a.js" as="script"><link rel="prefetch" href="/assets/index.html-c76ebe3c.js" as="script"><link rel="prefetch" href="/assets/index.html-10b418df.js" as="script"><link rel="prefetch" href="/assets/index.html-1e56f2c7.js" as="script"><link rel="prefetch" href="/assets/index.html-35c0ec79.js" as="script"><link rel="prefetch" href="/assets/index.html-9a0112e4.js" as="script"><link rel="prefetch" href="/assets/index.html-47ee4726.js" as="script"><link rel="prefetch" href="/assets/index.html-08add05f.js" as="script"><link rel="prefetch" href="/assets/index.html-4782abc8.js" as="script"><link rel="prefetch" href="/assets/index.html-9fe399b1.js" as="script"><link rel="prefetch" href="/assets/index.html-645a7c01.js" as="script"><link rel="prefetch" href="/assets/404.html-823b8c34.js" as="script"><link rel="prefetch" href="/assets/docsearch.min-b3127644.js" as="script"><link rel="prefetch" href="/assets/docsearch.min-49eb4b49.js" as="script"><link rel="prefetch" href="/assets/vue-bot-ui.common-017f2a86.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar fixed"><div class="navbar-header"><div class="navbar-header__logo-wrapper"><a href="/" class="home-link"><img class="logo" src="/global/logo.svg" alt="logo header"></a><div class="header-layout__search-container header-mobile__hidden"><!----><form id="search-form" class="drawer-header__input"><input value="" id="algolia-search-input" placeholder="Search" class="header-layout__search-default"><div class="header-layout__search-icon-default"><img alt="search icon" src="/global/search.svg"></div></form><div><div class="drawer"><div class="drawer-header"><div class="drawer-header__wrapper"><h2 class="drawer-header__paragraph">How can we help you?</h2><div id="drawerSearch"></div></div><div class="drawer-cross"><img class="drawer-cross__img" src="/global/cross.svg" alt="cross"><p class="drawer-cross__text">close</p></div></div><div class="drawer-tabs__wrapper" data-v-c60e280a><!--[--><!--]--></div><main><div class="drawer-main"><div class="drawer-main__wrapper"><div class="drawer-main__breadcrumb"><!----></div><!--[--><!----><div style="--18dc7fb0:15;"><p class="no_results">What are you searching for?</p></div><!--]--></div></div><!----></main></div><!----></div></div></div><div class="links" style="max-width:nullpx;"><img class="navbar-header__mobile-search" src="/global/search.svg" alt="icon image"><div class="header-products-wrapper"><div class="dropdown"><!----><!----><div class="header-products-container"><img class="header-products-container__img" alt="hamburger menu" src="/global/hamburger-menu.svg"><p class="header-products-wrapper-paragraph">Products</p><img class="products-icon__default" width="10" height="8" src="/arrows/arrow-down.svg" alt="arrow down icon"></div></div></div><!--[--><a target="_blank" class="btn">Ask GPT?</a><a href="https://www.imunify360.com/support-portal/" target="_blank" class="btn">Submit support request</a><a href="https://trial4.imunify360.com/" target="_blank" class="btn btn-white">Try Free</a><!--]--></div></div><!----></header><!----><div class="page"><!--[--><!--]--><div class="breadcrumb-wrapper page-breadcrumb" data-v-9445381a><span class="breadcrumb-title" data-v-9445381a>Documentation:</span><!--[--><a aria-current="page" href="/config_file_description/" class="router-link-active router-link-exact-active breadcrumb" data-v-9445381a>Config File Description</a><!--]--></div><img class="page-mobile__sidebar-menu" src="/global/sidebar-menu.svg" alt="sidebar hamburger menu"><div class="page-nav-wrapper"><!----></div><div class="content" custom="false"><h1 id="config-file-description" tabindex="-1"><a class="header-anchor" href="#config-file-description" aria-hidden="true">#</a> Config File Description</h1><p>Imunify360 config file is available on the following location after installation:</p><p><span class="notranslate"><em>/etc/sysconfig/imunify360/imunify360.config</em></span></p><p>In the config file it is possible to set up Imunify360 configuration. The following options are available:</p><div class="tip custom-block"><p class="custom-block-title"></p><p>Note that if YAML is used, it accepts any format: <code>True</code>/<code>true</code>/<code>yes</code>/<code>y</code>, etc. However, the CLI uses JSON which is strict – only lowercase <code>true</code>/<code>false</code>. Thus, if you are using the <code>imunify360-agent</code> CLI tool to make changes to the configuration, make sure you are using the lowercase.</p></div><table><tr><th colspan="2" align="left"><span class="notranslate">AUTO_WHITELIST:</span></th></tr><tr><td width="250px;"><span class="notranslate">timeout: 1440</span></td><td># set in minutes how long to keep automatically whitelisted IP</td></tr><tr><td><span class="notranslate">after_unblock_timeout: 1440</span></td><td> # set in minutes for how long IP will be added to the <span class="notranslate">White List</span> after it passes Imunify360 CAPTCHA</td></tr><tr><th colspan="2" align="left"><span class="notranslate">DOS:</span></th></tr><tr><td width="250px;"><span class="notranslate">enabled: True</span></td><td># allows to enable (<span class="notranslate">True</span>, the default value) or disable (<span class="notranslate">False</span>) DOS detection</td></tr><tr><td><span class="notranslate">interval: 30</span></td><td># interval in seconds between DoS detection system activation</td></tr><tr><td><span class="notranslate">default_limit: 250</span></td><td># maximum default limit of connections from remote IP to local port before DoS protection will be triggered. Cannot be set lower than 100</td></tr><tr><td><span class="notranslate">port_limits:</span></td><td># allows to set limits per local port</td></tr><tr><td>80: 150 </td><td># limit on port 80 is set to 150 connections</td></tr><tr><th colspan="2" align="left"><span class="notranslate">ENHANCED_DOS:</span></th></tr><tr><td width="250px;"><span class="notranslate">enabled: True</span></td><td># allows to enable or disable (<span class="notranslate">False</span>) the Enhanced DOS protection</td></tr><tr><td><span class="notranslate">time_frame: 60</span></td><td># the default timeframe in seconds between the Enhanced DoS detection system activation</td></tr><tr><td><span class="notranslate">default_limit: 500</span></td><td># the threshold of requests (their number) from remote IP to local port before the Enhanced DoS protection will be triggered.</td></tr><tr><td><span class="notranslate">port_limits:</span></td><td># allows to set requests limits for different ports</td></tr><tr><td>80: 300 </td><td># limit on port 80 is set to 300 connections</td></tr><tr><th colspan="2" align="left"><span class="notranslate">FIREWALL:</span></th></tr><tr><td width="250px;"><span class="notranslate">port_blocking_mode: ALLOW</span></td><td># allows to set firewall port blocking mode.<br><br><b>ALLOW (default)</b> - allow all except specified.<br><b>DENY</b> - block all except specified.<br><br> Exact ports and port-ranges to be allowed can be configured by the following fields in the config file:<br> - FIREWALL.TCP_IN_IPv4<br> - FIREWALL.TCP_OUT_IPv4<br> - FIREWALL.UDP_IN_IPv4<br> - FIREWALL.UDP_OUT_IPv4<br><br> Changes of config files will be applied automatically. You don’t need to restart the server or Imunify360.<br><br><em><b>Please note, the feature doesn’t support IPv6 addresses at this moment and CSF needs to be disabled due to conflicts.</b></em></td></tr><tr><th colspan="2" align="left"><span class="notranslate">INCIDENT_LOGGING:</span></th></tr><tr><td width="250px;"><span class="notranslate">min_log_level: 4</span></td><td># minimum severity level for incidents displayed in UI. Please find the levels description <a href="/dashboard/#incidents-logging">here</a></td></tr><tr><td><span class="notranslate">num_days: 100</span></td><td># incidents older than <span class="notranslate"><em>num_days</em></span> are automatically deleted</td></tr><tr><td><span class="notranslate">limit: 100000</span></td><td># how many incidents should be stored in Imunify360 log file</td></tr><tr><td><span class="notranslate">ui_autorefresh_timeout: 10</span></td><td># set auto refresh time for incidents in user interface</td></tr><tr><th colspan="2" align="left"><span class="notranslate">LOGGER:</span></th></tr><tr><td width="250px;"><span class="notranslate">max_log_file_size: 62914560</span></td><td># defines the maximum size of the log file in bytes (default is 60 MB)</td></tr><tr><td width="250px;"><span class="notranslate">backup_count: 5</span></td><td># defines how many log files to store. If 5, it will store <span class="notranslate"><em>app.log</em>, <em>app.log.1</em></span>, and up to <span class="notranslate"><em>app.log.5</em></span>.</td></tr><tr><td width="250px;"><span class="notranslate">syscall_monitor: False</span></td><td><p>Collect and report the source of suspicious actions using Syscall Monitor (<span class="notranslate">True</span>).</p> Supported operating systems: <ul><li>CentOS 6/7</li><li>CloudLinux OS 6/7.</li></ul> Additional requirements: <ul><li><b>auditd</b> needs to be installed</li><li><b>auditsp</b> needs to be switched off.</li></ul><p> Imunify360 uses auditd to discover malicious cron jobs that are not detected by other methods yet and thus block them much faster. </p><p> Additionally, it&#39;s also used for internal quality control and monitoring - e.g. if auditd records that PHP processes drop malware, but there are no related events/blocks from Proactive Defense, Imunify team receives an alert prompting an investigation. </p></td></tr><tr><th align="left"><span class="notranslate">MOD_SEC:</span></th><th align="left"><span class="notranslate"># defines ModSecurity settings</span></th></tr><tr><td width="250px;"><span class="notranslate">ruleset: FULL</span></td><td># defines what ruleset to use: <span class="notranslate">FULL</span> (default value) or <span class="notranslate">MINIMAL</span>. If the amount of RAM on the server is less than 2.1GB, the ruleset value is automatically set to <span class="notranslate">MINIMAL</span>.</td></tr><tr><td width="250px;"><span class="notranslate">cms_account_compromise_prevention: False</span></td><td># enables WordPress account brute-force protection. Default is False.</td></tr><tr><td width="250px;"><span class="notranslate">app_specific_ruleset: True</span></td><td># enables WAF Rules Auto-Configurator. Default is True.</td></tr><tr><td width="250px;"><span class="notranslate">prev_settings: </span></td><td># for internal usage, do not edit</td></tr><tr><th colspan="2" align="left"><span class="notranslate">MOD_SEC_BLOCK_BY_SEVERITY:</span></th></tr><tr><td><span class="notranslate">enable: True</span></td><td># allows to enable or disable option that moves IPs to <span class="notranslate">Gray List</span> if the ModSecurity rule is triggered</td></tr><tr><td><span class="notranslate">max_incidents: 2</span></td><td># set a number of repeats of the ModSecurity incident from the same IP for adding it to <span class="notranslate">Gray List</span></td></tr><tr><td><span class="notranslate">denied_num_limit: 2</span></td><td># set a number of repeats of the ModSecurity incidents that got Access Denied error from the same IP for adding it to <span class="notranslate">Gray List</span></td></tr><tr><td><span class="notranslate">check_period: 120</span></td><td># set a period in seconds during which incident from the same IP will be recorded as a repeat</td></tr><tr><td><span class="notranslate">severity_limit: 2</span></td><td># set a level of severity for DOS detection sensitivity. <a href="/dashboard/#settings">Read more</a> about severity levels</td></tr><tr><th align="left"><span class="notranslate">MOD_SEC_BLOCK_BY_CUSTOM_RULE:</span></th><th align="left"># this section allows to add custom configuration for blocking by ModSecurity incidents</th></tr><tr><td>33332:</td><td># set ModSecurity rule ID</td></tr><tr><td><span class="notranslate">check_period: 120</span></td><td># set a period in seconds during which incident from the same IP will be recorded as a repeat</td></tr><tr><td><span class="notranslate">max_incidents: 10</span></td><td># set a number of repeats of the ModSecurity incident from the same IP for adding it to <span class="notranslate">Gray List</span></td></tr><tr><th colspan="2" align="left"><span class="notranslate">MALWARE_SCANNING:</span></th></tr><tr><td><span class="notranslate">try_restore_from_backup_first: False</span></td><td># allows to enable (<span class="notranslate">True</span>) or disable (<span class="notranslate">False</span> – the default value) automatic malicious file restore from backup if a clean copy exists, otherwise <span class="notranslate"><em>default_action</em></span> is applied</td></tr><tr><td><span class="notranslate">default_action: cleanup</span></td><td># default action on malicious file detected.<br> Available options: <ul><li><span class="notranslate"><b>notify</b></span> – just display in dashboard</li><li><span class="notranslate"><b>cleanup</b></span> – cleanup malicious file (default)</li></ul></td></tr><tr><td><span class="notranslate">enable_scan_inotify: True</span></td><td># enable (<span class="notranslate">True</span> (default)) or disable (<span class="notranslate">False</span>) real-time scanning for modified files using <a href="https://en.wikipedia.org/wiki/Inotify" target="_blank">inotify</a> library</td></tr><tr><td><span class="notranslate">enable_scan_pure_ftpd: True</span></td><td># enable (<span class="notranslate">True</span> (default)) or disable (<span class="notranslate">False</span>) real-time scanning for files uploaded through PureFTPd</td></tr><tr><td><span class="notranslate">enable_scan_modsec: True</span></td><td># enable (<span class="notranslate">True</span> (default) or disable (<span class="notranslate">False</span>) real-time scanning of all the files that were uploaded via http/https. Note that it requires <a href="https://modsecurity.org" target="_blank">ModSecurity</a> to be installed</td></tr><tr><td><span class="notranslate">max_signature_size_to_scan: 1048576</span></td><td># max file size to scan in the standard mode; value is set in bytes</td></tr><tr><td><span class="notranslate">max_cloudscan_size_to_scan: 10485760</span></td><td># max file size to scan in the cloud-assisted (by hashes) mode; value is set in bytes</td></tr><tr><td><span class="notranslate">max_mrs_upload_file: 10485760</span></td><td># max file size to upload to CloudLinux malware research service; value is set in bytes</td></tr><tr><td><span class="notranslate">detect_elf: True</span></td><td># enable (<span class="notranslate">True</span>) (default value) or disable (<span class="notranslate">False</span>) binary (ELF) malware detection</td></tr><tr><td><span class="notranslate">notify_on_detect: False</span></td><td># notify (<span class="notranslate">True</span>) or not (<span class="notranslate">False</span>) (default value) an admin when malware is detected</td></tr><tr><td><span class="notranslate">optimize_realtime_scan: True</span></td><td># enable (<span class="notranslate">True</span>) (default value) or disable (<span class="notranslate">False</span>) the <a href="https://docs.cloudlinux.com/cloudlinux_os_kernel/#file-change-api" target="_blank">File Change API</a> and <b>fanotify</b> support to reduce the system load while watching for file changes in comparison with inotify watch. You can find the comparison table <a href="/dashboard/#general-2">here</a></td></tr><tr><td><span class="notranslate">sends_file_for_analysis: True</span></td><td># send (<span class="notranslate">True</span>) (default value) or not (<span class="notranslate">False</span>) malicious and suspicious files to the Imunify team for analysis</td></tr><tr><td><span class="notranslate">i360_clamd: False</span></td><td># obsolete (not used)</td></tr><tr><td><span class="notranslate">show_clamav_results: False</span></td><td># obsolete (not used)</td></tr><tr><td><span class="notranslate">clamav_binary: True</span></td><td># obsolete (not used)</td></tr><tr><td><span class="notranslate">scan_modified_files: Null</span></td><td># enable (<span class="notranslate">True</span>) or disable (<span class="notranslate">False</span>) (default is not set). If disabled, it checks the file&#39;s timestamps (c/mtime) before scanning, and if the timestamp is not changed since the last scan, the file is skipped. Scanner&#39;s behaviour is based on other scan optimizations, therefore it is better to rely on default values and UI, although this parameter provides an option to overwrite this behaviour. This option is not available within UI.</td></tr><tr><td><span class="notranslate">cloud_assisted_scan: True</span></td><td># speed up scans by check file hashes using cloud database</td></tr><tr><td><span class="notranslate">rapid_scan: True</span></td><td># speeds up (<span class="notranslate">True</span>) (default value) ot not (<span class="notranslate">False</span>) repeated scans based on smart re-scan approach, local result caching and cloud-assisted scan.</td></tr><tr><td><span class="notranslate">rapid_scan_rescan_unchanging_files_frequency: null</span></td><td># defines what part of all files will be rescanned during each scan. For example, if set 10 then 1/10 part of all files will be rescanned. The default value `null` - means &quot;choose frequency based on scan schedule&quot;. E.g. month - 1, week - 5, day - 10.</td></tr><tr><td><span class="notranslate">hyperscan: True</span></td><td># allows to use (<span class="notranslate">True</span>) the regex matching Hyperscan library in Malware Scanner to greatly improve the scanning speed. <span class="notranslate">True</span> is the default value. Hyperscan requires its own signatures set that will be downloaded from the files.imunify360.com and compiled locally.<br><b>Platform requirements</b>:<br>* Hyperscan supports Debian, Ubuntu and CentOS/CloudLinux 7 and later.<br>* SSE3 processor instructions support. It is quite common nowadays, but may be lacking in virtual environments or in some rather old servers.</td></tr><tr><td><span class="notranslate">enable_scan_cpanel: False</span></td><td># enable (<span class="notranslate">True</span>) blocking malicious file uploads via cPanel File Manager. The default value is <span class="notranslate">False</span>. The type of operations processed are: edits and saves</td></tr><tr><td><span class="notranslate">crontabs: True</span></td><td># enable (<span class="notranslate">True</span>) scan of the system and user crontab files for malicious jobs. The default value is <span class="notranslate">True</span>.</td></tr><tr><th colspan="2" align="left"><span class="notranslate">CAPTCHA:</span></th></tr><tr><td><span class="notranslate">cert_refresh_timeout: 3600</span></td><td># set in seconds how often SSL certificate will be refreshed</td></tr><tr><th colspan="2" align="left"><span class="notranslate">CONTROL_PANEL:</span></th></tr><tr><td><span class="notranslate">compromised_user_password_reset: True</span></td><td># enables resetting passwords for compromised cPanel accounts. Upon activating this functionality, our platform will detect instances where a cPanel account password has been breached and will subsequently prevent access using the previous password. End-users will then be prompted to create a new password via the <a href="https://docs.cpanel.net/knowledge-base/security/how-to-reset-a-cpanel-account-password/" target="_blank">cPanel password reset process</a>.</td></tr><tr><th colspan="2" align="left"><span class="notranslate">ERROR_REPORTING:</span></th></tr><tr><td><span class="notranslate">enable: True</span></td><td># automatically report errors to imunify360 team</td></tr><tr><th colspan="2" align="left"><span class="notranslate">SEND_ADDITIONAL_DATA:</span></th></tr><tr><td><span class="notranslate">enable: True</span></td><td># send anonymized data from query string/post parameters and cookies. True is the default value.</td></tr><tr><th align="left"><span class="notranslate">NETWORK_INTERFACE:</span></th><th aligh="left"># manages for what network interfaces Imunify360 rules will be applied</th></tr><tr><td><span class="notranslate">eth_device: None</span></td><td># by default, Imunify360 will auto-configure iptables to filter all traffic. If you want iptables rules to be applied to a specific NIC only, list them here (e.g. <span class="notranslate">eth1</span>)</td></tr><tr><td><span class="notranslate">eth6_device: None</span></td><td># it is the same as <span class="notranslate"><em>eth_device</em></span>, but configures ip6tables to use specific device</td></tr><tr><td><span class="notranslate">eth_device_skip: []</span></td><td># if you don&#39;t want iptables\ip6tables rules to be applied to specific NICs, list them here (e.g <span class="notranslate">[eth1, eth2]</span>)</td></tr><tr><th colspan="2" align="left"><span class="notranslate">BACKUP_RESTORE:</span></th></tr><tr><td><span class="notranslate">max_days_in_backup: 90</span></td><td># restore from backup files that are not older than <span class="notranslate"><em>max_days_in_backup</em></span></td></tr><th colspan="2" align="left"><span class="notranslate">CAPTCHA_DOS:</span></th><tr><td><span class="notranslate">enabled: True</span></td><td># enable (<span class="notranslate">True</span> (default) or disable (<span class="notranslate">False</span>) CAPTCHA Dos protection</td></tr><tr><td><span class="notranslate">time_frame: 21600</span></td><td># set a period in seconds during which requests to CAPTCHA from the same IP will be recorded as repeated</td></tr><tr><td><span class="notranslate">max_count: 100</span></td><td># set the maximum number of repeated CAPTCHA requests after which IP is moved to the CAPTCHA Dos list without an ability to request CAPTCHA again</td></tr><tr><td><span class="notranslate">timeout: 864000</span></td><td># set in seconds the time on which to add the IP in CAPTCHA Dos list without an ability to request CAPTCHA again</td></tr><tr><th colspan="2" align="left"><span class="notranslate">BLOCKED_PORTS:</span></th></tr><tr><td><span class="notranslate">default_mode: allowed</span></td><td># defines the default state of ports which is not explicitly set by user (<span class="notranslate"><em>denied</em></span> by default or <span class="notranslate"><em>allowed</em></span> by default). Currently only <span class="notranslate"><em>allowed</em></span> is supported</td></tr><tr><th colspan="2" align="left"><span class="notranslate">WEBSHIELD:</span></th></tr><tr><td><span class="notranslate">known_proxies_support: True</span></td><td># enable CDN support, treat IPs behind CDN as any other IPs. (True is the default value).</td></tr><tr><td><span class="notranslate">enable: True</span></td><td># enable (True) (default value) or disable (False) WebShield</td></tr><tr><td><span class="notranslate">captcha_site_key: &quot;&quot;</span></td><td># your site key; required to show reCAPTCHA on the page</td></tr><tr><td><span class="notranslate">captcha_secret_key: &quot;&quot;</span></td><td># your secret key; required for communication between Google server and this server to get reCAPTCHA pass results</td></tr><tr><td><span class="notranslate">splash_screen: True</span></td><td># enable (<span class="notranslate">True</span>) or disable (<span class="notranslate">False</span>) Anti-bot protection</td></tr><tr><th colspan="2" align="left"><span class="notranslate">PROACTIVE_DEFENCE:</span></th></tr><tr><td><span class="notranslate">blamer: True</span></td><td># enable (<span class="notranslate">True</span> (default)) or disable (<span class="notranslate">False) Blamer</span>. See also: <a href="https://blog.imunify360.com/forcibly-enable-blamer" target="_blank">How to forcibly enable Blamer for all users on the server</a>.</td></tr><tr><td><span class="notranslate">mode: LOG</span></td><td># available modes:<ul><li><span class="notranslate">KILL</span></li><li><span class="notranslate">DISABLED</span></li><li><span class="notranslate">LOG</span> (default)</li></ul></td></tr><tr><td><span class="notranslate">php_immunity: False</span></td><td># enable (<span class="notranslate">True</span>) or disable (<span class="notranslate">False (default)) PHP Immunity </span> (allows to automatically detect &amp; patch vulnerabilities in software at the Proactive Defense level preventing re-infections through the same vulnerability). By enabling this feature, Blamer will be enabled as well and Proactive Defence switched into the KILL mode.</td></tr><tr><th colspan="2" align="left"><span class="notranslate">MALWARE_SCAN_INTENSITY:</span></th></tr><tr><td><span class="notranslate">cpu: 2</span></td><td># intensity level for CPU consumption. Can be set from 1 to 7, default is 2</td></tr><tr><td><span class="notranslate">io: 2</span></td><td># intensity level for file operations. Can be set from 1 to 7, default is 2</td></tr><tr><td><span class="notranslate">ram: 1024</span></td><td># intensity level for RAM consumption. The default value is 1024</td></tr><tr><th colspan="2" align="left"><span class="notranslate">MALWARE_SCAN_SCHEDULE:</span></th></tr><tr><td><span class="notranslate">day_of_month: &lt;next day after installation&gt;</span></td><td># when the background scan shall start, day of the month. Can be from 1 to 31, the default value is the &lt;next day after installation&gt;.</td></tr><tr><td><span class="notranslate">day_of_week: 0</span></td><td># when the background scan shall start, day of the week. Can be from 0 to 7 (0 for Sunday, 1 for Monday..., 7 for Sunday (again)), the default value is 0</td></tr><tr><td><span class="notranslate">hour: 3</span></td><td># when the background scan shall start, hour. Can be from 0 to 23, the default value is 3</td></tr><tr><td><span class="notranslate">interval: MONTH</span></td><td># interval of scan. Supported values: strings <span class="notranslate">`NONE`</span> (no scan), <span class="notranslate">`DAY`</span>, <span class="notranslate">`WEEK`</span>, <span class="notranslate">`MONTH`</span>, the default value is <span class="notranslate">`MONTH`</span></td></tr><tr><th align="left"><span class="notranslate">PAM:</span></th><th align="left"># effective way to prevent brute-force attacks against FTP/SSH</th></tr><tr><td><span class="notranslate">enable: False</span></td><td># enable (<span class="notranslate">True</span>) or disable (<span class="notranslate">False</span>) (default value) PAM brute-force attack protection</td></tr><tr><td><span class="notranslate">exim_dovecot_protection: False</span></td><td># enable (<span class="notranslate">True</span>) or disable (<span class="notranslate">False</span>) (default value) Exim+Dovecot brute-force attack protection against Dovecot brute-force attacks.</td></tr><tr><td><span class="notranslate">ftp_protection: False</span></td><td># enable (<span class="notranslate">True</span>) or disable (<span class="notranslate">False</span>) (default value) FTP brute-force attack protection.</td></tr><tr><td><span class="notranslate">exim_dovecot_native: True</span></td><td># enable (<span class="notranslate">True</span>) (default value) or disable (<span class="notranslate">False</span>) the Dovecot native module.</td></tr><tr><th align="left"><span class="notranslate">KERNELCARE:</span> (<b><!----></b>)</th><th align="left"># KernelCare extension for Imunify360 which allows tracing malicious invocations to detect privilege escalation attempts</th></tr><tr><td><span class="notranslate">edf: False</span> (<b><!----></b>)</td><td># enable (<span class="notranslate">True</span>) or disable (<span class="notranslate">False</span>) (default value) exploit detection framework</td></tr><tr><th colspan="2" align="left"><span class="notranslate">MALWARE_CLEANUP:</span></th></tr><tr><td><span class="notranslate">trim_file_instead_of_removal: True</span></td><td># do not remove infected file during cleanup but make the file zero-size (for malwares like web-shells) (<span class="notranslate">True</span>) (default value)</td></tr><tr><td><span class="notranslate">keep_original_files_days: 14</span></td><td># the original infected file is available for restore within the defined period. The default is 14 days. The minimum value is one day.</td></tr><tr><th colspan="2" align="left"><span class="notranslate">OSSEC:</span></th></tr><tr><td><span class="notranslate">active_response: False</span></td><td># block (<span class="notranslate">True</span>) access to a specific server port being attacked. The ports include FTP (21), SSH (any port) and SMTP (25, 465, 587). The default value is <span class="notranslate">False</span>.</td></tr><tr><th colspan="2" align="left"><span class="notranslate">ADMIN_CONTACTS:</span></th></tr><tr><td><span class="notranslate">emails: youremail@email.com</span></td><td># your email to receive reports about critical issues, security alerts or system misconfigurations detected on your servers.</td></tr><tr><th colspan="2" align="left"><span class="notranslate">SMTP_BLOCKING:</span></th></tr><tr><td><span class="notranslate">enable: False</span></td><td># enable (<span class="notranslate">True</span>) or disable (<span class="notranslate">False</span>) (default value) SMTP Traffic Management. When enabled, the outgoing SMTP traffic would be blocked according to the settings.</td></tr><tr><td><span class="notranslate">ports: 25,587,465</span></td><td># a list of the ports to be blocked. The defaults are: 25, 587,465.</td></tr><tr><td><span class="notranslate">allow_users:</span></td><td># a list of users to be ignored (not blocked). By default it is empty. Including Unix and cPanel users (if a process that sends an email has a UID of one of the `allow_users`, it will not be blocked).</td></tr><tr><td><span class="notranslate">allow_groups: mail</span></td><td># a list of the groups to be ignored (not blocked). By default it is empty. Including Unix and cPanel users (if a process that sends an email has a UID of one of the `allow_users`, it will not be blocked).</td></tr><tr><td><span class="notranslate">allow_local: False</span></td><td># block (<span class="notranslate">True</span>) all, except the local SMTP (localhost). <span class="notranslate">False</span> is the default value.</td></tr><tr><td><span class="notranslate">redirect: False</span></td><td># enable (<span class="notranslate">True</span>) or disable (<span class="notranslate">False</span>) (the default value) automatic redirection to the local ports for outgoing mail traffic.</td></tr><tr><th colspan="2" align="left"><span class="notranslate">CSF_INTEGRATION:</span></th></tr><tr><td><span class="notranslate">catch_lfd_events: False</span></td><td># let (<span class="notranslate">True</span>) Imunify360 use Login Failure Daemon (LFD) as a source for security events. Default is False.</td></tr><tr><th colspan="2" align="left"><span class="notranslate">PERMISSIONS:</span></th></tr><tr><td><span class="notranslate">support_form: True</span></td><td># show (<span class="notranslate">True</span>) (the default value) or hide (<span class="notranslate">False</span>) the Support icon in the Imunify360 UI.</td></tr><tr><td><span class="notranslate">user_ignore_list: True</span></td><td># show (<span class="notranslate">True</span>) (the default value) or hide (<span class="notranslate">False</span>) the Ignore List tab for end-users in the Imunify360 UI.</td></tr><tr><td><span class="notranslate">allow_malware_scan: False</span></td><td># enable (<span class="notranslate">True</span>) or disable (<span class="notranslate">False</span>) (the default value) “scan” action in the UI of the end-user.</td></tr><tr><td width="250px;"><span class="notranslate">advisor: True</span></td><td># enable (<span class="notranslate">True</span> - the default value) or disable (<span class="notranslate">False</span>) the Imunify Advisor.</td></tr><tr><td width="250px;"><span class="notranslate">user_override_malware_actions: False</span></td><td># <span class="notranslate">&quot;True&quot;</span> allows overriding of actions applied to malware by a regular user. E.g., users will be able to disable automatic cleanup for their own files even if it was enabled by the admin.</td></tr><tr><td width="250px;"><span class="notranslate">user_override_proactive_defense: False</span></td><td># <span class="notranslate">&quot;True&quot;</span> allows overriding of Proactive Defense work mode by a regular user. E.g., users will be able to switch Proactive Defense mode to <span class="notranslate">LOG</span> for their websites even if the admin has set it to <span class="notranslate">KILL</span>.</td></tr><tr><th colspan="2" align="left"><span class="notranslate">STOP_MANAGING:</span></th></tr><tr><td><span class="notranslate">modsec_directives: False</span></td><td># for internal usage, do not edit</td></tr><tr><th colspan="2" align="left"><span class="notranslate">WEB_SERVICES:</span></th></tr><tr><td><span class="notranslate">http_ports: </span></td><td># additional http ports for Captcha</td></tr><tr><td><span class="notranslate">https_ports: </span></td><td># additional https ports for Captcha</td></tr><tr><th colspan="2" align="left"><span class="notranslate">MALWARE_DATABASE_SCAN:</span></th></tr><tr><td><span class="notranslate">enable: True</span></td><td># enable (<span class="notranslate">True</span>) the Malware Database Scanner - a database antivirus with automated malware detection and clean-up of web applications. Requires MariaDB/MySQL DB management system version 5.5. Recommended version is 5.6+. Note, only WordPress databases are supported as for now.</td></tr></table><p><span class="notranslate">Active Response</span> is an ossec-driven (IDS) feature of Imunify360 which has been re-engineered to make it capable of blocking access to a specific server port being attacked.</p><p>The purpose of the feature is significantly reducing false positive rate while increasing its capabilities to detect and block aggressive brute force requests.</p><p>In order to activate <span class="notranslate">Active Response, </span>the following lines should be added into <span class="notranslate"><em>/etc/sysconfig/imunify360/imunify360.config</em></span>:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>OSSEC:
  active_response: True
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div> and then restart Imunify360 service: <div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>systemctl restart imunify360
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><h4 id="how-to-apply-changes-from-cli" tabindex="-1"><a class="header-anchor" href="#how-to-apply-changes-from-cli" aria-hidden="true">#</a> How to apply changes from CLI</h4><p>In order to apply changes via command-line interface (CLI), you can use the following command:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;SECTION&quot;: {&quot;parameter&quot;: value}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>For example, if you want to set <span class="notranslate"><code>MALWARE_SCAN_INTENSITY.cpu = 5</code></span> from a command line, then you should execute the following command:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;MALWARE_SCAN_INTENSITY&quot;: {&quot;cpu&quot;: 5}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>It is also possible to apply several parameters at once. For example:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;PAM&quot;: {&quot;exim_dovecot_protection&quot;: false, &quot;enable&quot;:true}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>For string configuration values, such as the administrator&#39;s email address, it is necessary to use the following command format:</p><div class="notranslate"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>imunify360-agent config update &#39;{&quot;ADMIN_CONTACTS&quot;: {&quot;emails&quot;: [&quot;email@domain.com&quot;]}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div></div><div class="page-edit"><div class="edit-link"><img src="/global/pen.svg" alt="icon pen"><a href="https://github.com/cloudlinux/imunify360-documentation/tree/master/docs/config_file_description/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a></div></div><div class="back-to-top" data-v-1eb13e00><a class="nav-arrow top back-to-top__link" data-v-1eb13e00><span class="back-to-top__link-span" data-v-1eb13e00>Scroll up</span></a></div><!--[--><!--]--></div><!----><div class="footer footer-default-layout" data-v-f2902e71><div class="footer__img" data-v-f2902e71><a href="https://cloudlinux.com" data-v-f2902e71><img src="/global/we-are-cloudlinux.svg" data-v-f2902e71></a></div><div class="footer-company-title" data-v-f2902e71>2024. CloudLinux Inc </div><div class="social" data-v-f2902e71><div class="social_links" data-v-f2902e71><!--[--><a href="https://cloudlinux.zendesk.com/hc/en-us/categories/360002375980-Imunify-Security-Products" target="_blank" data-v-f2902e71>Knowledge Base</a><a href="https://forum.cloudlinux.com/forum/imunify360" target="_blank" data-v-f2902e71>Forum</a><a href="https://blog.imunify360.com/" target="_blank" data-v-f2902e71>Blog</a><a href="https://www.cloudlinux.com/privacy-policy" target="_blank" data-v-f2902e71>Privacy Policy</a><!--]--></div><span class="footer-social-text" data-v-f2902e71>Stay in touch</span><div class="social-icons-wrapper" data-v-f2902e71><!--[--><a class="social-icons-link" href="https://www.facebook.com/imunify360/" target="_blank" data-v-f2902e71><img class="social-icons-link-img" src="/footer-social/fb.png" alt="footer logo" data-v-f2902e71></a><a class="social-icons-link" href="https://twitter.com/imunify360/" target="_blank" data-v-f2902e71><img class="social-icons-link-img" src="/footer-social/tw.png" alt="footer logo" data-v-f2902e71></a><a class="social-icons-link" href="https://linkedin.com/company/imunify360" target="_blank" data-v-f2902e71><img class="social-icons-link-img" src="/footer-social/in.png" alt="footer logo" data-v-f2902e71></a><a class="social-icons-link" href="https://www.youtube.com/channel/UCcW6dDJjcy41c7Hl_5LdLZQ" target="_blank" data-v-f2902e71><img class="social-icons-link-img" src="/footer-social/ytube.png" alt="footer logo" data-v-f2902e71></a><!--]--></div></div></div></div><!----><!--]--></div>
    <script type="module" src="/assets/app-5759a965.js" defer></script>
  </body>
</html>
